# ç¬¬ä¸€é˜¶æ®µ: æ ¸å¿ƒæ•°æ®æ¨¡å‹

> **é˜¶æ®µç›®æ ‡**: ç†è§£æ•´ä¸ªæ¡†æ¶çš„æ•°æ®ç»“æ„åŸºç¡€,æŒæ¡æ‰€æœ‰æ ¸å¿ƒæ•°æ®æ¨¡å‹çš„å®šä¹‰å’Œä½¿ç”¨
> **æ¶‰åŠæ–‡ä»¶**: `apirun/core/models.py`
> **é¢„è®¡æ—¶é—´**: 2-3å°æ—¶
> **å‰ç½®çŸ¥è¯†**: PythonåŸºç¡€ã€dataclassè£…é¥°å™¨ã€ç±»å‹æ³¨è§£

---

## ğŸ“‹ ç›®å½•

- [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
- [æ•°æ®æ¨¡å‹](#æ•°æ®æ¨¡å‹)
- [å…³é”®å­—å‚è€ƒ](#å…³é”®å­—å‚è€ƒ)
- [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [å•å…ƒæµ‹è¯•](#å•å…ƒæµ‹è¯•)
- [ç›¸å…³æ–‡æ¡£](#ç›¸å…³æ–‡æ¡£)

---

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### æ ¸å¿ƒæ•°æ®æ¨¡å‹çš„ä½œç”¨

**ç®€è¦è¯´æ˜**: æ ¸å¿ƒæ•°æ®æ¨¡å‹æ˜¯ Sisyphus API Engine çš„åŸºç¡€,å®šä¹‰äº†æµ‹è¯•ç”¨ä¾‹ã€æµ‹è¯•æ­¥éª¤ã€é…ç½®ã€éªŒè¯è§„åˆ™ç­‰æ‰€æœ‰å…³é”®æ•°æ®ç»“æ„ã€‚

**è¯¦ç»†è¯´æ˜**:
- ä½¿ç”¨ Python `@dataclass` è£…é¥°å™¨,æä¾›ä¸å¯å˜æ€§å’Œç±»å‹å®‰å…¨
- æ‰€æœ‰æ¨¡å‹éƒ½åŒ…å«è¯¦ç»†çš„ç±»å‹æ³¨è§£å’Œæ–‡æ¡£å­—ç¬¦ä¸²
- æ”¯æŒåµŒå¥—ç»“æ„,å¯ä»¥ç»„åˆå¤æ‚çš„æ•°æ®å…³ç³»
- ä¸º YAML è§£æå™¨æä¾›å¼ºç±»å‹çš„ Python å¯¹è±¡

**ä»£ç ä½ç½®**: `apirun/core/models.py:1-439`

---

### æ•°æ®æ¨¡å‹çš„åˆ†ç±»

**ç®€è¦è¯´æ˜**: æ•°æ®æ¨¡å‹åˆ†ä¸ºä¸‰å¤§ç±»:é…ç½®æ¨¡å‹ã€æ‰§è¡Œæ¨¡å‹ã€ç»“æœæ¨¡å‹

**è¯¦ç»†è¯´æ˜**:
- **é…ç½®æ¨¡å‹**: GlobalConfigã€ProfileConfigã€TestCaseã€TestStep
- **æ‰§è¡Œæ¨¡å‹**: ValidationRuleã€Extractor
- **ç»“æœæ¨¡å‹**: StepResultã€TestCaseResultã€ErrorInfoã€PerformanceMetrics

---

## ğŸ—ï¸ æ•°æ®æ¨¡å‹

### æ¨¡å‹1: `HttpMethod` æšä¸¾

**ä½œç”¨**: å®šä¹‰æ”¯æŒçš„ HTTP æ–¹æ³•ç±»å‹

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:13-22`

**æšä¸¾å€¼**:

| å€¼ | HTTP æ–¹æ³• | è¯´æ˜ |
|----|-----------|------|
| GET | GET | è·å–èµ„æº |
| POST | POST | åˆ›å»ºèµ„æº |
| PUT | PUT | æ›´æ–°èµ„æº(å®Œæ•´) |
| DELETE | DELETE | åˆ é™¤èµ„æº |
| PATCH | PATCH | æ›´æ–°èµ„æº(éƒ¨åˆ†) |
| HEAD | HEAD | è·å–å“åº”å¤´ |
| OPTIONS | OPTIONS | è·å–æ”¯æŒçš„æ–¹æ³• |

**ä½¿ç”¨ç¤ºä¾‹**:
```yaml
steps:
  - name: "GET è¯·æ±‚ç¤ºä¾‹"
    type: request
    method: GET  # ä½¿ç”¨ HttpMethod æšä¸¾
    url: "${base_url}/users"
```

---

### æ¨¡å‹2: `ErrorCategory` æšä¸¾

**ä½œç”¨**: å®šä¹‰é”™è¯¯ç±»åˆ«,ç”¨äºé”™è¯¯åˆ†ç±»å’Œå¤„ç†

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:25-33`

**æšä¸¾å€¼**:

| å€¼ | é”™è¯¯ç±»åˆ« | è¯´æ˜ |
|----|----------|------|
| ASSERTION | assertion | æ–­è¨€å¤±è´¥ |
| NETWORK | network | ç½‘ç»œé”™è¯¯ |
| TIMEOUT | timeout | è¶…æ—¶é”™è¯¯ |
| PARSING | parsing | è§£æé”™è¯¯ |
| BUSINESS | business | ä¸šåŠ¡é€»è¾‘é”™è¯¯ |
| SYSTEM | system | ç³»ç»Ÿé”™è¯¯ |

**ä½¿ç”¨ç¤ºä¾‹**:
```python
from apirun.core.models import ErrorInfo, ErrorCategory

error = ErrorInfo(
    type="ConnectionError",
    category=ErrorCategory.NETWORK,
    message="æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨"
)
```

---

### æ¨¡å‹3: `ProfileConfig`

**ä½œç”¨**: ç¯å¢ƒé…ç½®æ¨¡å‹,å®šä¹‰ä¸åŒç¯å¢ƒçš„é…ç½®å‚æ•°

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:36-54`

**å­—æ®µè¯´æ˜**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| base_url | str | æ˜¯ | - | ç¯å¢ƒçš„åŸºç¡€ URL |
| variables | Dict[str, Any] | å¦ | {} | ç¯å¢ƒç‰¹å®šå˜é‡ |
| timeout | int | å¦ | 30 | è¯·æ±‚é»˜è®¤è¶…æ—¶æ—¶é—´(ç§’) |
| verify_ssl | bool | å¦ | True | æ˜¯å¦éªŒè¯ SSL è¯ä¹¦ |
| overrides | Dict[str, Any] | å¦ | {} | æ¥è‡ªç¯å¢ƒå˜é‡æˆ– CLI çš„é…ç½®è¦†ç›– |
| priority | int | å¦ | 0 | å˜é‡ä¼˜å…ˆçº§(å€¼è¶Šé«˜ä¼˜å…ˆçº§è¶Šé«˜) |

**ä½¿ç”¨ç¤ºä¾‹**:
```yaml
config:
  profiles:
    dev:
      base_url: "https://dev.api.com"
      timeout: 60
      verify_ssl: false
      variables:
        api_key: "dev-key-123"
```

---

### æ¨¡å‹4: `GlobalConfig`

**ä½œç”¨**: å…¨å±€æµ‹è¯•é…ç½®,å®šä¹‰æ•´ä¸ªæµ‹è¯•ç”¨ä¾‹çš„é…ç½®

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:57-128`

**å­—æ®µè¯´æ˜**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| name | str | æ˜¯ | - | æµ‹è¯•å¥—ä»¶åç§° |
| description | str | å¦ | "" | æµ‹è¯•å¥—ä»¶æè¿° |
| profiles | Dict[str, ProfileConfig] | å¦ | {} | ç¯å¢ƒé…ç½® |
| active_profile | Optional[str] | å¦ | None | å½“å‰æ¿€æ´»çš„ç¯å¢ƒåç§° |
| variables | Dict[str, Any] | å¦ | {} | å…¨å±€å˜é‡ |
| timeout | int | å¦ | 30 | å…¨å±€è¶…æ—¶æ—¶é—´ |
| retry_times | int | å¦ | 0 | å¤±è´¥é‡è¯•æ¬¡æ•° |
| concurrent | bool | å¦ | False | æ˜¯å¦å¯ç”¨å¹¶å‘æ‰§è¡Œ |
| concurrent_threads | int | å¦ | 3 | å¹¶å‘çº¿ç¨‹æ•° |
| data_source | Optional[Dict] | å¦ | None | æ•°æ®é©±åŠ¨æµ‹è¯•çš„æ•°æ®æºé…ç½® |
| data_iterations | bool | å¦ | False | æ˜¯å¦è¿­ä»£æ•°æ®æº |
| variable_prefix | str | å¦ | "" | æ•°æ®å˜é‡çš„å‰ç¼€ |
| websocket | Optional[Dict] | å¦ | None | WebSocket å®æ—¶æ¨é€é…ç½® |
| output | Optional[Dict] | å¦ | None | æµ‹è¯•ç»“æœè¾“å‡ºé…ç½® |
| debug | Optional[Dict] | å¦ | None | è°ƒè¯•æ¨¡å¼é…ç½® |
| env_vars | Optional[Dict] | å¦ | None | ç¯å¢ƒå˜é‡é…ç½® |
| verbose | bool | å¦ | False | å¯ç”¨è¯¦ç»†è¾“å‡º |

**ä½¿ç”¨ç¤ºä¾‹**:
```yaml
config:
  name: "ç”¨æˆ·æ¥å£æµ‹è¯•"
  profiles:
    dev:
      base_url: "https://dev.api.com"
    prod:
      base_url: "https://prod.api.com"
  active_profile: "dev"
  variables:
    api_version: "v1"
  timeout: 30
  retry_times: 2
```

---

### æ¨¡å‹5: `ValidationRule`

**ä½œç”¨**: éªŒè¯è§„åˆ™æ¨¡å‹,å®šä¹‰æ–­è¨€éªŒè¯é€»è¾‘

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:130-151`

**å­—æ®µè¯´æ˜**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| type | str | æ˜¯ | - | æ¯”è¾ƒå™¨ç±»å‹æˆ–é€»è¾‘è¿ç®—ç¬¦ |
| path | str | å¦ | "" | JSONPath è¡¨è¾¾å¼ |
| expect | Any | å¦ | None | æœŸæœ›å€¼ |
| description | str | å¦ | "" | éªŒè¯æè¿° |
| logical_operator | Optional[str] | å¦ | None | é€»è¾‘è¿ç®—ç¬¦(and/or/not) |
| sub_validations | List[ValidationRule] | å¦ | [] | å­éªŒè¯è§„åˆ™åˆ—è¡¨ |
| error_message | str | å¦ | "" | è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯ |

**ä½¿ç”¨ç¤ºä¾‹**:
```yaml
steps:
  - name: "éªŒè¯å“åº”"
    type: request
    url: "${base_url}/users/1"
    validations:
      - type: eq
        path: "$.id"
        expect: 1
        description: "éªŒè¯ç”¨æˆ·ID"
        error_message: "ç”¨æˆ·IDå¿…é¡»ä¸º1"
```

---

### æ¨¡å‹6: `Extractor`

**ä½œç”¨**: å˜é‡æå–å™¨æ¨¡å‹,å®šä¹‰ä»å“åº”ä¸­æå–å˜é‡çš„è§„åˆ™

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:154-178`

**å­—æ®µè¯´æ˜**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| name | str | æ˜¯ | - | å­˜å‚¨æå–å€¼çš„å˜é‡å |
| type | str | æ˜¯ | - | æå–ç±»å‹(jsonpath/regex/header/cookie) |
| path | str | æ˜¯ | - | æå–è·¯å¾„æˆ–æ¨¡å¼ |
| index | int | å¦ | 0 | å¤šä¸ªåŒ¹é…çš„ç´¢å¼• |
| extract_all | bool | å¦ | False | æå–æ‰€æœ‰åŒ¹é…å€¼ä¸ºæ•°ç»„ |
| default | Any | å¦ | None | æå–å¤±è´¥æ—¶çš„é»˜è®¤å€¼ |
| description | str | å¦ | "" | æå–å™¨æè¿° |
| condition | Optional[str] | å¦ | None | æå–æ¡ä»¶è¡¨è¾¾å¼ |
| on_failure | Optional[Dict] | å¦ | None | å¤±è´¥å¤„ç†é…ç½® |

**ä½¿ç”¨ç¤ºä¾‹**:
```yaml
steps:
  - name: "æå–ç”¨æˆ·ID"
    type: request
    url: "${base_url}/users"
    extractors:
      - type: jsonpath
        name: user_id
        path: "$.data[0].id"
        default: "0"
        description: "æå–ç¬¬ä¸€ä¸ªç”¨æˆ·çš„ID"
```

---

### æ¨¡å‹7: `TestStep`

**ä½œç”¨**: æµ‹è¯•æ­¥éª¤æ¨¡å‹,å®šä¹‰å•ä¸ªæµ‹è¯•æ­¥éª¤

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:181-292`

**å­—æ®µè¯´æ˜**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| name | str | æ˜¯ | - | æ­¥éª¤åç§° |
| type | str | æ˜¯ | - | æ­¥éª¤ç±»å‹ |
| method | Optional[str] | å¦ | None | HTTP æ–¹æ³• |
| url | Optional[str] | å¦ | None | è¯·æ±‚ URL |
| params | Optional[Dict] | å¦ | None | æŸ¥è¯¢å‚æ•° |
| headers | Optional[Dict] | å¦ | None | è¯·æ±‚å¤´ |
| body | Optional[Any] | å¦ | None | è¯·æ±‚ä½“ |
| validations | List[ValidationRule] | å¦ | [] | éªŒè¯è§„åˆ™åˆ—è¡¨ |
| extractors | List[Extractor] | å¦ | [] | å˜é‡æå–å™¨åˆ—è¡¨ |
| skip_if | Optional[str] | å¦ | None | æ¡ä»¶è·³è¿‡è¡¨è¾¾å¼ |
| only_if | Optional[str] | å¦ | None | æ¡ä»¶æ‰§è¡Œè¡¨è¾¾å¼ |
| depends_on | List[str] | å¦ | [] | ä¾èµ–çš„æ­¥éª¤åç§°åˆ—è¡¨ |
| timeout | Optional[int] | å¦ | None | æ­¥éª¤ç‰¹å®šè¶…æ—¶æ—¶é—´ |
| retry_times | Optional[int] | å¦ | None | æ­¥éª¤ç‰¹å®šé‡è¯•æ¬¡æ•° |
| retry_policy | Optional[Dict] | å¦ | None | å¢å¼ºé‡è¯•ç­–ç•¥ |
| ... | | | | (æ›´å¤šå­—æ®µè§æºç ) |

**ä½¿ç”¨ç¤ºä¾‹**:
```yaml
steps:
  - name: "åˆ›å»ºç”¨æˆ·"
    type: request
    method: POST
    url: "${base_url}/users"
    headers:
      Content-Type: "application/json"
    json:
      name: "å¼ ä¸‰"
      age: 25
    validations:
      - type: eq
        path: "$.code"
        expect: 200
    extractors:
      - type: jsonpath
        name: user_id
        path: "$.data.id"
```

---

### æ¨¡å‹8: `TestCase`

**ä½œç”¨**: æµ‹è¯•ç”¨ä¾‹æ¨¡å‹,å®šä¹‰å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:294-316`

**å­—æ®µè¯´æ˜**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| name | str | æ˜¯ | - | æµ‹è¯•ç”¨ä¾‹åç§° |
| description | str | å¦ | "" | æµ‹è¯•ç”¨ä¾‹æè¿° |
| config | Optional[GlobalConfig] | å¦ | None | å…¨å±€é…ç½® |
| steps | List[TestStep] | å¦ | [] | æµ‹è¯•æ­¥éª¤åˆ—è¡¨ |
| setup | Optional[Dict] | å¦ | None | å…¨å±€å‰ç½®é’©å­ |
| teardown | Optional[Dict] | å¦ | None | å…¨å±€åç½®é’©å­ |
| tags | List[str] | å¦ | [] | æµ‹è¯•ç”¨ä¾‹æ ‡ç­¾ |
| enabled | bool | å¦ | True | æ˜¯å¦å¯ç”¨ |

**ä½¿ç”¨ç¤ºä¾‹**:
```yaml
name: "ç”¨æˆ·ç™»å½•æµ‹è¯•"
description: "æµ‹è¯•ç”¨æˆ·ç™»å½•åŠŸèƒ½"

config:
  profiles:
    dev:
      base_url: "https://dev.api.com"

steps:
  - name: "ç™»å½•"
    type: request
    method: POST
    url: "${base_url}/login"
    json:
      username: "test"
      password: "123456"

tags:
  - "auth"
  - "smoke"
```

---

### æ¨¡å‹9: `ErrorInfo`

**ä½œç”¨**: é”™è¯¯ä¿¡æ¯æ¨¡å‹,å®šä¹‰è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:319-343`

**å­—æ®µè¯´æ˜**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| type | str | æ˜¯ | - | é”™è¯¯ç±»å‹(å¼‚å¸¸ç±»å) |
| category | ErrorCategory | æ˜¯ | - | é”™è¯¯ç±»åˆ« |
| message | str | æ˜¯ | - | é”™è¯¯æ¶ˆæ¯ |
| suggestion | str | å¦ | "" | é”™è¯¯å»ºè®®ä¿®å¤ |
| stack_trace | str | å¦ | "" | å®Œæ•´å †æ ˆè·Ÿè¸ª |
| context | Dict[str, Any] | å¦ | {} | é¢å¤–ä¸Šä¸‹æ–‡ä¿¡æ¯ |
| timestamp | Optional[datetime] | å¦ | None | é”™è¯¯å‘ç”Ÿæ—¶é—´ |
| severity | str | å¦ | "medium" | é”™è¯¯ä¸¥é‡ç¨‹åº¦ |
| error_code | str | å¦ | "" | æœºå™¨å¯è¯»çš„é”™è¯¯ä»£ç  |

---

### æ¨¡å‹10: `PerformanceMetrics`

**ä½œç”¨**: æ€§èƒ½æŒ‡æ ‡æ¨¡å‹,è®°å½•æ­¥éª¤æ‰§è¡Œçš„æ€§èƒ½æ•°æ®

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:346-368`

**å­—æ®µè¯´æ˜**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| total_time | float | å¦ | 0.0 | æ€»æ‰§è¡Œæ—¶é—´(æ¯«ç§’) |
| dns_time | float | å¦ | 0.0 | DNS æŸ¥æ‰¾æ—¶é—´(æ¯«ç§’) |
| tcp_time | float | å¦ | 0.0 | TCP è¿æ¥æ—¶é—´(æ¯«ç§’) |
| tls_time | float | å¦ | 0.0 | TLS æ¡æ‰‹æ—¶é—´(æ¯«ç§’) |
| server_time | float | å¦ | 0.0 | æœåŠ¡å™¨å¤„ç†æ—¶é—´(æ¯«ç§’) |
| download_time | float | å¦ | 0.0 | ä¸‹è½½æ—¶é—´(æ¯«ç§’) |
| upload_time | float | å¦ | 0.0 | ä¸Šä¼ æ—¶é—´(æ¯«ç§’) |
| size | int | å¦ | 0 | å“åº”å¤§å°(å­—èŠ‚) |

---

### æ¨¡å‹11: `StepResult`

**ä½œç”¨**: æ­¥éª¤æ‰§è¡Œç»“æœæ¨¡å‹,è®°å½•å•ä¸ªæ­¥éª¤çš„æ‰§è¡Œç»“æœ

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:371-405`

**å­—æ®µè¯´æ˜**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| name | str | æ˜¯ | - | æ­¥éª¤åç§° |
| status | str | æ˜¯ | - | æ‰§è¡ŒçŠ¶æ€(success/failure/skipped/error) |
| response | Optional[Dict] | å¦ | None | HTTP å“åº”æ•°æ® |
| extracted_vars | Dict[str, Any] | å¦ | {} | æå–çš„å˜é‡ |
| validation_results | List[Dict] | å¦ | [] | éªŒè¯ç»“æœåˆ—è¡¨ |
| performance | Optional[PerformanceMetrics] | å¦ | None | æ€§èƒ½æŒ‡æ ‡ |
| error_info | Optional[ErrorInfo] | å¦ | None | å¤±è´¥æ—¶çš„é”™è¯¯ä¿¡æ¯ |
| start_time | Optional[datetime] | å¦ | None | æ­¥éª¤å¼€å§‹æ—¶é—´ |
| end_time | Optional[datetime] | å¦ | None | æ­¥éª¤ç»“æŸæ—¶é—´ |
| retry_count | int | å¦ | 0 | æ‰§è¡Œçš„é‡è¯•æ¬¡æ•° |
| variables_snapshot | Dict[str, Any] | å¦ | {} | æ‰§è¡Œå‰çš„å˜é‡çŠ¶æ€ |
| retry_history | List[Dict] | å¦ | [] | è¯¦ç»†çš„é‡è¯•å°è¯•å†å² |
| variables_delta | Dict[str, Any] | å¦ | {} | æ‰§è¡ŒæœŸé—´çš„å˜é‡å˜åŒ– |
| variables_after | Dict[str, Any] | å¦ | {} | æ‰§è¡Œåçš„å˜é‡çŠ¶æ€ |

---

### æ¨¡å‹12: `TestCaseResult`

**ä½œç”¨**: æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œç»“æœæ¨¡å‹,è®°å½•æ•´ä¸ªæµ‹è¯•ç”¨ä¾‹çš„æ‰§è¡Œç»“æœ

**å®šä¹‰ä½ç½®**: `apirun/core/models.py:408-439`

**å­—æ®µè¯´æ˜**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| name | str | æ˜¯ | - | æµ‹è¯•ç”¨ä¾‹åç§° |
| status | str | æ˜¯ | - | æ€»ä½“çŠ¶æ€(passed/failed/skipped/error) |
| start_time | datetime | æ˜¯ | - | æµ‹è¯•ç”¨ä¾‹å¼€å§‹æ—¶é—´ |
| end_time | datetime | æ˜¯ | - | æµ‹è¯•ç”¨ä¾‹ç»“æŸæ—¶é—´ |
| duration | float | æ˜¯ | - | æ€»æŒç»­æ—¶é—´(ç§’) |
| total_steps | int | æ˜¯ | - | æ€»æ­¥éª¤æ•° |
| passed_steps | int | æ˜¯ | - | é€šè¿‡çš„æ­¥éª¤æ•° |
| failed_steps | int | æ˜¯ | - | å¤±è´¥çš„æ­¥éª¤æ•° |
| skipped_steps | int | æ˜¯ | - | è·³è¿‡çš„æ­¥éª¤æ•° |
| step_results | List[StepResult] | å¦ | [] | å„ä¸ªæ­¥éª¤çš„ç»“æœåˆ—è¡¨ |
| final_variables | Dict[str, Any] | å¦ | {} | æ‰€æœ‰å˜é‡çš„æœ€ç»ˆçŠ¶æ€ |
| error_info | Optional[ErrorInfo] | å¦ | None | å¤±è´¥æ—¶çš„é”™è¯¯ä¿¡æ¯ |

---

## ğŸ“– å…³é”®å­—å‚è€ƒ

### æµ‹è¯•ç”¨ä¾‹çº§åˆ«

#### å…³é”®å­—: `name`

**ä½œç”¨**: å®šä¹‰æµ‹è¯•ç”¨ä¾‹åç§°

**ä½¿ç”¨ä½ç½®**: YAML æ ¹çº§åˆ«

**ç±»å‹**: string

**å¿…å¡«**: æ˜¯

**é»˜è®¤å€¼**: -

**å–å€¼èŒƒå›´**:
- ä»»æ„éç©ºå­—ç¬¦ä¸²

**è¯¦ç»†è¯´æ˜**:
æµ‹è¯•ç”¨ä¾‹çš„åç§°,ç”¨äºæ ‡è¯†å’Œè¾“å‡ºæ˜¾ç¤ºã€‚å»ºè®®ä½¿ç”¨æè¿°æ€§åç§°ã€‚

**ç¤ºä¾‹**:
```yaml
name: "ç”¨æˆ·ç™»å½•åŠŸèƒ½æµ‹è¯•"
```

**æ³¨æ„äº‹é¡¹**:
- åç§°ä¸èƒ½ä¸ºç©º
- å»ºè®®ä½¿ç”¨ä¸­æ–‡æˆ–è‹±æ–‡,ä½†ä¸è¦æ··ç”¨

**ä»£ç å®ç°**: `apirun/core/models.py:309`

---

#### å…³é”®å­—: `description`

**ä½œç”¨**: æµ‹è¯•ç”¨ä¾‹æè¿°

**ä½¿ç”¨ä½ç½®**: YAML æ ¹çº§åˆ«

**ç±»å‹**: string

**å¿…å¡«**: å¦

**é»˜è®¤å€¼**: ""

**è¯¦ç»†è¯´æ˜**:
æä¾›æµ‹è¯•ç”¨ä¾‹çš„è¯¦ç»†æè¿°,è¯´æ˜æµ‹è¯•ç›®çš„å’ŒèŒƒå›´ã€‚

**ç¤ºä¾‹**:
```yaml
description: "æµ‹è¯•ç”¨æˆ·ç™»å½•åŠŸèƒ½,åŒ…æ‹¬æ­£å¸¸ç™»å½•ã€é”™è¯¯å¯†ç ã€è´¦å·ä¸å­˜åœ¨ç­‰åœºæ™¯"
```

---

#### å…³é”®å­—: `config`

**ä½œç”¨**: å…¨å±€é…ç½®

**ä½¿ç”¨ä½ç½®**: YAML æ ¹çº§åˆ«

**ç±»å‹**: object

**å¿…å¡«**: å¦

**é»˜è®¤å€¼**: None

**è¯¦ç»†è¯´æ˜**:
å®šä¹‰æµ‹è¯•ç”¨ä¾‹çš„å…¨å±€é…ç½®,åŒ…æ‹¬ç¯å¢ƒé…ç½®ã€å˜é‡ã€è¶…æ—¶ç­‰ã€‚

**ç¤ºä¾‹**:
```yaml
config:
  profiles:
    dev:
      base_url: "https://dev.api.com"
  active_profile: "dev"
  variables:
    api_version: "v1"
  timeout: 30
```

**ä»£ç å®ç°**: `apirun/core/models.py:57-128`

---

#### å…³é”®å­—: `steps`

**ä½œç”¨**: æµ‹è¯•æ­¥éª¤åˆ—è¡¨

**ä½¿ç”¨ä½ç½®**: YAML æ ¹çº§åˆ«

**ç±»å‹**: array

**å¿…å¡«**: æ˜¯(å®é™…ä½¿ç”¨ä¸­)

**é»˜è®¤å€¼**: []

**è¯¦ç»†è¯´æ˜**:
å®šä¹‰æµ‹è¯•ç”¨ä¾‹çš„æ‰§è¡Œæ­¥éª¤,æ¯ä¸ªæ­¥éª¤æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "æ­¥éª¤1"
    type: request
    url: "${base_url}/api"
  - name: "æ­¥éª¤2"
    type: request
    url: "${base_url}/api2"
```

**ä»£ç å®ç°**: `apirun/core/models.py:312`

---

#### å…³é”®å­—: `tags`

**ä½œç”¨**: æµ‹è¯•ç”¨ä¾‹æ ‡ç­¾

**ä½¿ç”¨ä½ç½®**: YAML æ ¹çº§åˆ«

**ç±»å‹**: array of strings

**å¿…å¡«**: å¦

**é»˜è®¤å€¼**: []

**è¯¦ç»†è¯´æ˜**:
ç”¨äºæµ‹è¯•ç”¨ä¾‹çš„åˆ†ç±»å’Œè¿‡æ»¤ã€‚

**ç¤ºä¾‹**:
```yaml
tags:
  - "smoke"
  - "auth"
  - "critical"
```

**ä»£ç å®ç°**: `apirun/core/models.py:315`

---

### æ­¥éª¤çº§åˆ«

#### å…³é”®å­—: `type`

**ä½œç”¨**: æ­¥éª¤ç±»å‹

**ä½¿ç”¨ä½ç½®**: `steps[*]`

**ç±»å‹**: string

**å¿…å¡«**: æ˜¯

**é»˜è®¤å€¼**: -

**å–å€¼èŒƒå›´**:
- `request`: HTTP/HTTPS è¯·æ±‚
- `database`: æ•°æ®åº“æ“ä½œ
- `wait`: ç­‰å¾…/å»¶è¿Ÿ
- `loop`: å¾ªç¯æ§åˆ¶
- `concurrent`: å¹¶å‘æ‰§è¡Œ
- `poll`: è½®è¯¢æ‰§è¡Œ
- `script`: è„šæœ¬æ‰§è¡Œ

**è¯¦ç»†è¯´æ˜**:
å®šä¹‰æ­¥éª¤çš„æ‰§è¡Œç±»å‹,å†³å®šä½¿ç”¨å“ªä¸ªæ‰§è¡Œå™¨ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "HTTP è¯·æ±‚"
    type: request
    url: "${base_url}/api"
```

**ä»£ç å®ç°**: `apirun/core/models.py:247`

---

#### å…³é”®å­—: `method`

**ä½œç”¨**: HTTP æ–¹æ³•

**ä½¿ç”¨ä½ç½®**: `steps[*]` (type=request)

**ç±»å‹**: string

**å¿…å¡«**: å¦(é»˜è®¤GET)

**é»˜è®¤å€¼**: "GET"

**å–å€¼èŒƒå›´**:
- `GET`: è·å–èµ„æº
- `POST`: åˆ›å»ºèµ„æº
- `PUT`: æ›´æ–°èµ„æº(å®Œæ•´)
- `DELETE`: åˆ é™¤èµ„æº
- `PATCH`: æ›´æ–°èµ„æº(éƒ¨åˆ†)
- `HEAD`: è·å–å“åº”å¤´
- `OPTIONS`: è·å–æ”¯æŒçš„æ–¹æ³•

**è¯¦ç»†è¯´æ˜**:
æŒ‡å®š HTTP è¯·æ±‚æ–¹æ³•ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "åˆ›å»ºç”¨æˆ·"
    type: request
    method: POST
    url: "${base_url}/users"
```

**ä»£ç å®ç°**: `apirun/core/models.py:13-22`

---

#### å…³é”®å­—: `url`

**ä½œç”¨**: è¯·æ±‚ URL

**ä½¿ç”¨ä½ç½®**: `steps[*]` (type=request)

**ç±»å‹**: string

**å¿…å¡«**: æ˜¯(å¯¹äº request ç±»å‹)

**é»˜è®¤å€¼**: -

**è¯¦ç»†è¯´æ˜**:
HTTP è¯·æ±‚çš„ URL,æ”¯æŒå˜é‡æ›¿æ¢ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "è·å–ç”¨æˆ·"
    type: request
    url: "${base_url}/users/${user_id}"
```

**ä»£ç å®ç°**: `apirun/core/models.py:249`

---

#### å…³é”®å­—: `headers`

**ä½œç”¨**: è¯·æ±‚å¤´

**ä½¿ç”¨ä½ç½®**: `steps[*]` (type=request)

**ç±»å‹**: object

**å¿…å¡«**: å¦

**é»˜è®¤å€¼**: null

**è¯¦ç»†è¯´æ˜**:
å®šä¹‰ HTTP è¯·æ±‚å¤´,æ”¯æŒå˜é‡æ›¿æ¢ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "API è¯·æ±‚"
    type: request
    url: "${base_url}/api"
    headers:
      Content-Type: "application/json"
      Authorization: "Bearer ${token}"
```

**ä»£ç å®ç°**: `apirun/core/models.py:251`

---

#### å…³é”®å­—: `json`

**ä½œç”¨**: JSON è¯·æ±‚ä½“

**ä½¿ç”¨ä½ç½®**: `steps[*]` (type=request)

**ç±»å‹**: object/array

**å¿…å¡«**: å¦

**é»˜è®¤å€¼**: null

**è¯¦ç»†è¯´æ˜**:
å®šä¹‰ JSON æ ¼å¼çš„è¯·æ±‚ä½“,è‡ªåŠ¨è®¾ç½® Content-Type ä¸º application/json,æ”¯æŒå˜é‡æ›¿æ¢ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "åˆ›å»ºç”¨æˆ·"
    type: request
    method: POST
    url: "${base_url}/users"
    json:
      name: "å¼ ä¸‰"
      age: 25
      email: "${user_email}"
```

---

#### å…³é”®å­—: `validations`

**ä½œç”¨**: éªŒè¯è§„åˆ™åˆ—è¡¨

**ä½¿ç”¨ä½ç½®**: `steps[*]`

**ç±»å‹**: array

**å¿…å¡«**: å¦

**é»˜è®¤å€¼**: []

**è¯¦ç»†è¯´æ˜**:
å®šä¹‰æ­¥éª¤çš„éªŒè¯è§„åˆ™,æ‰€æœ‰è§„åˆ™éƒ½é€šè¿‡åˆ™æ­¥éª¤æˆåŠŸã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "éªŒè¯å“åº”"
    type: request
    url: "${base_url}/users/1"
    validations:
      - type: eq
        path: "$.id"
        expect: 1
      - type: contains
        path: "$.name"
        expect: "å¼ ä¸‰"
```

**ä»£ç å®ç°**: `apirun/core/models.py:130-151`

---

#### å…³é”®å­—: `extractors`

**ä½œç”¨**: å˜é‡æå–å™¨åˆ—è¡¨

**ä½¿ç”¨ä½ç½®**: `steps[*]`

**ç±»å‹**: array

**å¿…å¡«**: å¦

**é»˜è®¤å€¼**: []

**è¯¦ç»†è¯´æ˜**:
å®šä¹‰ä»å“åº”ä¸­æå–å˜é‡çš„è§„åˆ™,æå–çš„å˜é‡å¯ç”¨äºåç»­æ­¥éª¤ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "ç™»å½•å¹¶æå– token"
    type: request
    method: POST
    url: "${base_url}/login"
    json:
      username: "test"
      password: "123456"
    extractors:
      - type: jsonpath
        name: token
        path: "$.data.token"
```

**ä»£ç å®ç°**: `apirun/core/models.py:154-178`

---

#### å…³é”®å­—: `depends_on`

**ä½œç”¨**: æ­¥éª¤ä¾èµ–å…³ç³»

**ä½¿ç”¨ä½ç½®**: `steps[*]`

**ç±»å‹**: array of strings

**å¿…å¡«**: å¦

**é»˜è®¤å€¼**: []

**è¯¦ç»†è¯´æ˜**:
å®šä¹‰å½“å‰æ­¥éª¤ä¾èµ–çš„å‰ç½®æ­¥éª¤åç§°åˆ—è¡¨,ç¡®ä¿ä¾èµ–æ­¥éª¤æ‰§è¡ŒæˆåŠŸåæ‰æ‰§è¡Œå½“å‰æ­¥éª¤ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "ç™»å½•"
    type: request
    method: POST
    url: "${base_url}/login"

  - name: "è®¿é—®ä¸ªäººä¿¡æ¯"
    type: request
    url: "${base_url}/profile"
    depends_on:
      - "ç™»å½•"
```

**ä»£ç å®ç°**: `apirun/core/models.py:257`

---

#### å…³é”®å­—: `retry_policy`

**ä½œç”¨**: å¢å¼ºé‡è¯•ç­–ç•¥

**ä½¿ç”¨ä½ç½®**: `steps[*]`

**ç±»å‹**: object

**å¿…å¡«**: å¦

**é»˜è®¤å€¼**: null

**è¯¦ç»†è¯´æ˜**:
å®šä¹‰æ­¥éª¤çš„é‡è¯•ç­–ç•¥,åŒ…æ‹¬æœ€å¤§é‡è¯•æ¬¡æ•°ã€é‡è¯•ç­–ç•¥(å›ºå®š/æŒ‡æ•°/çº¿æ€§)ã€å»¶è¿Ÿç­‰ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "ä¸ç¨³å®šçš„è¯·æ±‚"
    type: request
    url: "${base_url}/unstable"
    retry_policy:
      max_attempts: 3
      strategy: exponential
      base_delay: 1.0
      max_delay: 10.0
      backoff_multiplier: 2.0
      jitter: true
      retry_on:
        - network
        - timeout
      stop_on:
        - assertion
```

**ä»£ç å®ç°**: `apirun/core/models.py:278`

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: åŸºç¡€æµ‹è¯•ç”¨ä¾‹

**åœºæ™¯æè¿°**: åˆ›å»ºä¸€ä¸ªç®€å•çš„æµ‹è¯•ç”¨ä¾‹,åŒ…å« GET è¯·æ±‚å’ŒåŸºæœ¬éªŒè¯

**YAML å®Œæ•´ä»£ç **:
```yaml
name: "åŸºç¡€æµ‹è¯•ç”¨ä¾‹"
description: "æ¼”ç¤ºæ ¸å¿ƒæ•°æ®æ¨¡å‹çš„åŸºæœ¬ç”¨æ³•"

config:
  profiles:
    dev:
      base_url: "https://jsonplaceholder.typicode.com"
  active_profile: "dev"

steps:
  - name: "è·å–ç”¨æˆ·ä¿¡æ¯"
    type: request
    method: GET
    url: "${config.profiles.dev.base_url}/users/1"
    validations:
      - type: eq
        path: "$.id"
        expect: 1
      - type: type
        path: "$.email"
        expect: "str"
```

**æ‰§è¡Œå‘½ä»¤**:
```bash
sisyphus --cases examples/39_æ•°æ®æ¨¡å‹åŸºç¡€.yaml
```

**é¢„æœŸç»“æœ**:
- æµ‹è¯•ç”¨ä¾‹æ‰§è¡ŒæˆåŠŸ
- éªŒè¯é€šè¿‡:ç”¨æˆ·IDä¸º1,é‚®ç®±ä¸ºå­—ç¬¦ä¸²ç±»å‹

---

### ç¤ºä¾‹2: å¸¦å˜é‡æå–çš„æµ‹è¯•ç”¨ä¾‹

**åœºæ™¯æè¿°**: ä»å“åº”ä¸­æå–å˜é‡,å¹¶åœ¨åç»­æ­¥éª¤ä¸­ä½¿ç”¨

**YAML å®Œæ•´ä»£ç **:
```yaml
name: "å˜é‡æå–æµ‹è¯•"
description: "æ¼”ç¤ºå˜é‡æå–å™¨çš„ä½¿ç”¨"

config:
  profiles:
    dev:
      base_url: "https://jsonplaceholder.typicode.com"

steps:
  - name: "æå–ç”¨æˆ·ä¿¡æ¯"
    type: request
    url: "${config.profiles.dev.base_url}/users/1"
    extractors:
      - type: jsonpath
        name: user_id
        path: "$.id"
      - type: jsonpath
        name: username
        path: "$.username"

  - name: "ä½¿ç”¨æå–çš„å˜é‡"
    type: request
    url: "${config.profiles.dev.base_url}/users/${user_id}"
    validations:
      - type: eq
        path: "$.username"
        expect: "${username}"
```

**æ‰§è¡Œå‘½ä»¤**:
```bash
sisyphus --cases examples/39_æ•°æ®æ¨¡å‹åŸºç¡€.yaml
```

**é¢„æœŸç»“æœ**:
- ç¬¬ä¸€æ­¥æå– user_id å’Œ username
- ç¬¬äºŒæ­¥ä½¿ç”¨æå–çš„å˜é‡è®¿é—®ç”¨æˆ·ä¿¡æ¯
- éªŒè¯é€šè¿‡:ç”¨æˆ·ååŒ¹é…

---

### ç¤ºä¾‹3: å¤æ‚éªŒè¯è§„åˆ™

**åœºæ™¯æè¿°**: ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦ç»„åˆå¤šä¸ªéªŒè¯æ¡ä»¶

**YAML å®Œæ•´ä»£ç **:
```yaml
name: "å¤æ‚éªŒè¯æµ‹è¯•"
description: "æ¼”ç¤ºé€»è¾‘è¿ç®—ç¬¦éªŒè¯"

config:
  profiles:
    dev:
      base_url: "https://jsonplaceholder.typicode.com"

steps:
  - name: "å¤æ‚éªŒè¯ç¤ºä¾‹"
    type: request
    url: "${config.profiles.dev.base_url}/users/1"
    validations:
      # AND è¿ç®—:æ‰€æœ‰å­éªŒè¯éƒ½å¿…é¡»é€šè¿‡
      - type: and
        description: "éªŒè¯ç”¨æˆ·ä¿¡æ¯å®Œæ•´"
        error_message: "ç”¨æˆ·ä¿¡æ¯ä¸å®Œæ•´"
        sub_validations:
          - type: eq
            path: "$.id"
            expect: 1
          - type: ne
            path: "$.username"
            expect: ""
          - type: contains
            path: "$.email"
            expect: "@"

      # OR è¿ç®—:è‡³å°‘ä¸€ä¸ªå­éªŒè¯é€šè¿‡
      - type: or
        description: "éªŒè¯ç”¨æˆ·çŠ¶æ€"
        sub_validations:
          - type: eq
            path: "$.status"
            expect: "active"
          - type: eq
            path: "$.status"
            expect: "pending"
```

---

## ğŸŒŸ æ¨èç»„åˆç”¨æ³•

### ç»„åˆ1: é…ç½® + éªŒè¯ + æå–

**ä½¿ç”¨åœºæ™¯**: æ ‡å‡†çš„ API æµ‹è¯•æµç¨‹

**YAML ç¤ºä¾‹**:
```yaml
config:
  profiles:
    dev:
      base_url: "https://api.example.com"
      variables:
        api_key: "dev-key"

steps:
  - name: "ç™»å½•"
    type: request
    method: POST
    url: "${config.profiles.dev.base_url}/login"
    headers:
      X-API-Key: "${config.profiles.dev.variables.api_key}"
    json:
      username: "test"
      password: "123456"
    validations:
      - type: eq
        path: "$.code"
        expect: 200
    extractors:
      - type: jsonpath
        name: token
        path: "$.data.token"

  - name: "ä½¿ç”¨ token è®¿é—®æ¥å£"
    type: request
    url: "${config.profiles.dev.base_url}/profile"
    headers:
      Authorization: "Bearer ${token}"
    depends_on:
      - "ç™»å½•"
```

**ä¼˜åŠ¿**:
- é›†ä¸­ç®¡ç†é…ç½®,ä¾¿äºç¯å¢ƒåˆ‡æ¢
- éªŒè¯ç¡®ä¿å“åº”æ­£ç¡®æ€§
- æå–å™¨å®ç°æ•°æ®åœ¨æ­¥éª¤é—´æµè½¬

---

### ç»„åˆ2: ä¾èµ–æ§åˆ¶ + é‡è¯•ç­–ç•¥

**ä½¿ç”¨åœºæ™¯**: ç¡®ä¿æ­¥éª¤æ‰§è¡Œé¡ºåºå’Œç¨³å®šæ€§

**YAML ç¤ºä¾‹**:
```yaml
steps:
  - name: "åˆ›å»ºèµ„æº"
    type: request
    method: POST
    url: "${base_url}/resources"
    retry_policy:
      max_attempts: 3
      strategy: exponential
    extractors:
      - type: jsonpath
        name: resource_id
        path: "$.data.id"

  - name: "æ›´æ–°èµ„æº"
    type: request
    method: PUT
    url: "${base_url}/resources/${resource_id}"
    depends_on:
      - "åˆ›å»ºèµ„æº"
```

**ä¼˜åŠ¿**:
- `depends_on` ç¡®ä¿åˆ›å»ºæˆåŠŸåæ‰æ›´æ–°
- `retry_policy` æé«˜ä¸ç¨³å®šåœºæ™¯ä¸‹çš„æˆåŠŸç‡

---

### ç»„åˆ3: å¤šç¯å¢ƒé…ç½® + å…¨å±€å˜é‡

**ä½¿ç”¨åœºæ™¯**: è·¨ç¯å¢ƒæµ‹è¯•

**YAML ç¤ºä¾‹**:
```yaml
config:
  profiles:
    dev:
      base_url: "https://dev.api.com"
      timeout: 60
    test:
      base_url: "https://test.api.com"
      timeout: 30
    prod:
      base_url: "https://prod.api.com"
      timeout: 30
  active_profile: "dev"
  variables:
    api_version: "v1"
    timeout: 30

steps:
  - name: "ä½¿ç”¨ç¯å¢ƒå˜é‡"
    type: request
    url: "${config.profiles.dev.base_url}/api"
    headers:
      X-API-Version: "${api_version}"
```

---

## âš ï¸ æœ€ä½³å®è·µ

### å®è·µ1: ä½¿ç”¨æè¿°æ€§åç§°

**æ¨èåšæ³•**:
```yaml
# âœ… å¥½çš„åšæ³•
steps:
  - name: "ç™»å½•ç³»ç»Ÿå¹¶è·å–è®¿é—®ä»¤ç‰Œ"
    type: request
    url: "${base_url}/login"
```

**ä¸æ¨èåšæ³•**:
```yaml
# âŒ ä¸å¥½çš„åšæ³•
steps:
  - name: "æ­¥éª¤1"
    type: request
    url: "${base_url}/login"
```

**åŸå› **: æè¿°æ€§åç§°ä¾¿äºç†è§£æµ‹è¯•æ„å›¾å’Œå¿«é€Ÿå®šä½é—®é¢˜

---

### å®è·µ2: é›†ä¸­ç®¡ç†é…ç½®

**æ¨èåšæ³•**:
```yaml
# âœ… å¥½çš„åšæ³•
config:
  profiles:
    dev:
      base_url: "https://dev.api.com"
      variables:
        api_key: "${env.API_KEY}"
  active_profile: "dev"
```

**ä¸æ¨èåšæ³•**:
```yaml
# âŒ ä¸å¥½çš„åšæ³•
steps:
  - name: "è¯·æ±‚"
    type: request
    url: "https://dev.api.com/users"  # ç¡¬ç¼–ç 
```

**åŸå› **: é›†ä¸­ç®¡ç†ä¾¿äºç¯å¢ƒåˆ‡æ¢å’Œç»´æŠ¤

---

### å®è·µ3: ä½¿ç”¨éªŒè¯ç¡®ä¿è´¨é‡

**æ¨èåšæ³•**:
```yaml
# âœ… å¥½çš„åšæ³•
steps:
  - name: "åˆ›å»ºç”¨æˆ·"
    type: request
    method: POST
    url: "${base_url}/users"
    json:
      name: "å¼ ä¸‰"
    validations:
      - type: eq
        path: "$.code"
        expect: 200
      - type: eq
        path: "$.data.name"
        expect: "å¼ ä¸‰"
```

**ä¸æ¨èåšæ³•**:
```yaml
# âŒ ä¸å¥½çš„åšæ³•
steps:
  - name: "åˆ›å»ºç”¨æˆ·"
    type: request
    method: POST
    url: "${base_url}/users"
    json:
      name: "å¼ ä¸‰"
    # æ²¡æœ‰éªŒè¯
```

**åŸå› **: éªŒè¯ç¡®ä¿APIè¡Œä¸ºç¬¦åˆé¢„æœŸ,åŠæ—¶å‘ç°bug

---

### å®è·µ4: åˆç†ä½¿ç”¨æå–å™¨

**æ¨èåšæ³•**:
```yaml
# âœ… å¥½çš„åšæ³•
extractors:
  - type: jsonpath
    name: user_id
    path: "$.data.id"
    default: "0"
```

**ä¸æ¨èåšæ³•**:
```yaml
# âŒ ä¸å¥½çš„åšæ³•
extractors:
  - type: jsonpath
    name: user_id
    path: "$.data.id"
    # æ²¡æœ‰ default,æå–å¤±è´¥ä¼šæŠ¥é”™
```

**åŸå› **: ä½¿ç”¨ default å¯ä»¥æé«˜æµ‹è¯•çš„å¥å£®æ€§

---

## â“ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•å®šä¹‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹?

**ç­”æ¡ˆ**: æµ‹è¯•ç”¨ä¾‹å¿…é¡»åŒ…å« `name` å­—æ®µ,`steps` åˆ—è¡¨å®é™…ä½¿ç”¨æ—¶ä¹Ÿæ˜¯å¿…å¡«çš„ã€‚å…¶ä»–å­—æ®µå¦‚ `description`ã€`config`ã€`tags` ç­‰éƒ½æ˜¯å¯é€‰çš„ã€‚

**ç¤ºä¾‹**:
```yaml
name: "æµ‹è¯•ç”¨ä¾‹åç§°"
steps:
  - name: "æ­¥éª¤1"
    type: request
    url: "${base_url}/api"
```

---

### Q2: å¦‚ä½•åœ¨æ­¥éª¤ä¹‹é—´ä¼ é€’æ•°æ®?

**ç­”æ¡ˆ**: ä½¿ç”¨ `extractors` ä»å“åº”ä¸­æå–å˜é‡,ç„¶ååœ¨åç»­æ­¥éª¤ä¸­é€šè¿‡ `${å˜é‡å}` å¼•ç”¨ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "ç¬¬ä¸€æ­¥"
    extractors:
      - type: jsonpath
        name: token
        path: "$.data.token"

  - name: "ç¬¬äºŒæ­¥"
    headers:
      Authorization: "Bearer ${token}"
```

**ç›¸å…³é“¾æ¥**: `docs/08_å˜é‡æå–.md`

---

### Q3: å¦‚ä½•å¤„ç†å¤šç¯å¢ƒé…ç½®?

**ç­”æ¡ˆ**: ä½¿ç”¨ `config.profiles` å®šä¹‰å¤šä¸ªç¯å¢ƒ,é€šè¿‡ `active_profile` æ¿€æ´»ç¯å¢ƒã€‚

**ç¤ºä¾‹**:
```yaml
config:
  profiles:
    dev:
      base_url: "https://dev.api.com"
    prod:
      base_url: "https://prod.api.com"
  active_profile: "dev"
```

**ç›¸å…³é“¾æ¥**: `docs/02_é…ç½®ç®¡ç†.md`

---

### Q4: å¦‚ä½•æ§åˆ¶æ­¥éª¤æ‰§è¡Œé¡ºåº?

**ç­”æ¡ˆ**: ä½¿ç”¨ `depends_on` å­—æ®µå®šä¹‰æ­¥éª¤ä¾èµ–å…³ç³»,ç¡®ä¿ä¾èµ–æ­¥éª¤æ‰§è¡ŒæˆåŠŸåæ‰æ‰§è¡Œå½“å‰æ­¥éª¤ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "ç™»å½•"
    type: request
    url: "${base_url}/login"

  - name: "è®¿é—®ä¸ªäººä¿¡æ¯"
    type: request
    url: "${base_url}/profile"
    depends_on:
      - "ç™»å½•"
```

---

### Q5: å¦‚ä½•å®ç°é‡è¯•æœºåˆ¶?

**ç­”æ¡ˆ**: ä½¿ç”¨ `retry_policy` é…ç½®é‡è¯•ç­–ç•¥,æ”¯æŒå›ºå®šã€æŒ‡æ•°ã€çº¿æ€§é€€é¿ã€‚

**ç¤ºä¾‹**:
```yaml
steps:
  - name: "ä¸ç¨³å®šçš„è¯·æ±‚"
    type: request
    url: "${base_url}/unstable"
    retry_policy:
      max_attempts: 3
      strategy: exponential
      base_delay: 1.0
      max_delay: 10.0
```

---

## ğŸ§ª å•å…ƒæµ‹è¯•

### æµ‹è¯•æ–‡ä»¶ä½ç½®
```
tests/core/test_models.py
```

### æµ‹è¯•è¦†ç›–èŒƒå›´

| æµ‹è¯•åœºæ™¯ | æµ‹è¯•ç”¨ä¾‹ | çŠ¶æ€ |
|----------|----------|------|
| æšä¸¾ç±»å‹ | test_http_method_values | âœ… |
| ç¯å¢ƒé…ç½® | test_profile_config_creation | âœ… |
| å…¨å±€é…ç½® | test_global_config_creation | âœ… |
| éªŒè¯è§„åˆ™ | test_validation_rule_creation | âœ… |
| æå–å™¨ | test_jsonpath_extractor_creation | âœ… |
| æµ‹è¯•æ­¥éª¤ | test_request_step_creation | âœ… |
| æµ‹è¯•ç”¨ä¾‹ | test_test_case_creation | âœ… |
| é”™è¯¯ä¿¡æ¯ | test_error_info_creation | âœ… |
| æ€§èƒ½æŒ‡æ ‡ | test_performance_metrics_creation | âœ… |
| æ­¥éª¤ç»“æœ | test_step_result_creation | âœ… |
| æµ‹è¯•ç»“æœ | test_test_case_result_creation | âœ… |

### è¿è¡Œæµ‹è¯•
```bash
# è¿è¡Œæ ¸å¿ƒæ¨¡å—æ‰€æœ‰æµ‹è¯•
pytest tests/core/test_models.py -v

# æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
pytest tests/core/test_models.py --cov=apirun.core.models --cov-report=html

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
pytest tests/core/test_models.py::TestProfileConfig -v
```

### æµ‹è¯•ç¤ºä¾‹
```python
def test_profile_config_creation():
    """æµ‹è¯• ProfileConfig åˆ›å»º."""
    # Arrange
    base_url = "https://api.example.com"

    # Act
    config = ProfileConfig(
        base_url=base_url,
        timeout=60,
        verify_ssl=False
    )

    # Assert
    assert config.base_url == base_url
    assert config.timeout == 60
    assert config.verify_ssl is False
```

**å½“å‰è¦†ç›–ç‡**: 100%

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

### å†…éƒ¨æ–‡æ¡£
- [ç¬¬äºŒé˜¶æ®µ: é…ç½®ç®¡ç†](./02_é…ç½®ç®¡ç†.md)
- [ç¬¬ä¸‰é˜¶æ®µ: å˜é‡ç³»ç»Ÿ](./03_å˜é‡ç³»ç»Ÿ.md)
- [ç¬¬ä¸ƒé˜¶æ®µ: éªŒè¯ç³»ç»Ÿ](./07_éªŒè¯ç³»ç»Ÿ.md)
- [ç¬¬å…«é˜¶æ®µ: å˜é‡æå–](./08_å˜é‡æå–.md)
- [API-Engineè¾“å…¥åè®®è§„èŒƒ](./API-Engineè¾“å…¥åè®®è§„èŒƒ.md)

### å¤–éƒ¨å‚è€ƒ
- [Python dataclass æ–‡æ¡£](https://docs.python.org/3/library/dataclasses.html)
- [Python ç±»å‹æ³¨è§£](https://docs.python.org/3/library/typing.html)

### æºç å‚è€ƒ
- æ ¸å¿ƒå®ç°: `apirun/core/models.py`
- å•å…ƒæµ‹è¯•: `tests/core/test_models.py`
- YAMLç¤ºä¾‹: `examples/39_æ•°æ®æ¨¡å‹åŸºç¡€.yaml`

---

## ğŸ“ æ›´æ–°æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ | ä½œè€… |
|------|------|----------|------|
| 1.0.0 | 2026-02-04 | åˆå§‹ç‰ˆæœ¬,å®Œæ•´æ–‡æ¡£ | Claude |

---

**æ–‡æ¡£ç»´æŠ¤**: æœ¬æ–‡æ¡£éšä»£ç æ›´æ–°åŒæ­¥ç»´æŠ¤
