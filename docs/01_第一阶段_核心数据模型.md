# 第一阶段: 核心数据模型

> **阶段目标**: 理解整个框架的数据结构基础，掌握所有核心数据模型的定义和使用
> **涉及文件**: `apirun/core/models.py`
> **预计时间**: 2-3小时
> **前置知识**: Python基础、dataclass装饰器、类型注解

---

## 📋 目录

- [核心概念](#核心概念)
- [数据模型](#数据模型)
- [关键字参考](#关键字参考)
- [使用示例](#使用示例)
- [最佳实践](#最佳实践)
- [常见问题](#常见问题)
- [单元测试](#单元测试)
- [相关文档](#相关文档)

---

## 🎯 核心概念

### 核心数据模型的作用

**简要说明**: 核心数据模型是整个 Sisyphus API Engine 的基础，定义了测试用例、测试步骤、配置、结果等所有核心数据结构。

**设计原则**:
- 使用 `@dataclass` 装饰器简化数据类定义
- 严格的类型注解（Type Hints）
- 提供合理的默认值
- 支持不可变性（Immutable）

**代码位置**: `apirun/core/models.py`

> **⚠️ 注意**: 本文档为占位符，详细内容将在代码 review 后补充。请参考 `docs/template_docs.md` 了解文档结构规范。

---

## 📊 数据模型

### 1. HttpMethod 枚举

**作用**: 定义支持的 HTTP 方法类型

**定义位置**: `apirun/core/models.py:13-22`

**支持的值**:
- GET
- POST
- PUT
- DELETE
- PATCH
- HEAD
- OPTIONS

---

### 2. ErrorCategory 枚举

**作用**: 定义错误分类

**定义位置**: `apirun/core/models.py:25-33`

**支持的值**:
- ASSERTION: 断言失败
- NETWORK: 网络错误
- TIMEOUT: 超时错误
- PARSING: 解析错误
- BUSINESS: 业务错误
- SYSTEM: 系统错误

---

### 3. ProfileConfig 配置模型

**作用**: 环境配置模型（dev/test/prod等）

**定义位置**: `apirun/core/models.py:36-54`

**字段说明**:

| 字段名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| base_url | str | 是 | - | 环境的基础URL |
| variables | Dict[str, Any] | 否 | {} | 环境特定变量 |
| timeout | int | 否 | 30 | 默认超时时间（秒） |
| verify_ssl | bool | 否 | True | 是否验证SSL证书 |
| overrides | Dict[str, Any] | 否 | {} | 配置覆盖项 |
| priority | int | 否 | 0 | 变量优先级 |

---

## 📖 关键字参考

> **待补充**: 本节将在代码 review 后详细补充所有 YAML 关键字及其用法

---

## 💡 使用示例

### 基础示例

```yaml
name: "测试用例示例"
description: "这是一个基础的测试用例"

steps:
  - name: "示例步骤"
    type: request
    url: "https://api.example.com/users"
```

---

## 🌟 推荐组合用法

> **待补充**: 本节将在详细文档中补充

---

## ⚠️ 最佳实践

> **待补充**: 本节将在详细文档中补充

---

## ❓ 常见问题

### Q1: 如何定义一个测试用例？

**答案**: 测试用例必须包含 `name` 和 `steps` 字段，其他字段可选。

---

## 🧪 单元测试

### 测试文件位置
```
tests/core/test_models.py
```

### 测试覆盖范围

| 测试场景 | 测试用例 | 状态 |
|----------|----------|------|
| 模型创建 | test_profile_config_creation | ⏳ 待编写 |
| 字段验证 | test_model_field_validation | ⏳ 待编写 |
| 默认值 | test_model_default_values | ⏳ 待编写 |

### 运行测试
```bash
# 运行核心模块测试
pytest tests/core/test_models.py -v
```

---

## 📚 相关文档

### 内部文档
- [项目重构学习大纲](./00_项目重构学习大纲与任务清单.md)
- [文档模板规范](./template_docs.md)
- [API-Engine输入协议规范](./API-Engine输入协议规范.md)

### 源码参考
- 核心实现: `apirun/core/models.py`
- 单元测试: `tests/core/test_models.py`

---

## 📝 更新日志

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|----------|------|
| 0.1.0 | 2026-02-03 | 创建占位符 | Claude |

---

**文档状态**: 🚧 占位符 - 待详细内容补充
