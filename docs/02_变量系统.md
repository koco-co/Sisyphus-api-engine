# å˜é‡ç³»ç»Ÿ

> æŒæ¡ Sisyphus å¼ºå¤§çš„å˜é‡ç®¡ç†å’Œæ¨¡æ¿æ¸²æŸ“åŠŸèƒ½ã€‚

---

## ğŸ“– æ¦‚è¿°

å˜é‡ç³»ç»Ÿæ˜¯ Sisyphus çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œæ”¯æŒå¤šç§å˜é‡æ¥æºã€æ¨¡æ¿æ¸²æŸ“ã€å˜é‡ä½œç”¨åŸŸç®¡ç†ç­‰é«˜çº§ç‰¹æ€§ã€‚é€šè¿‡å˜é‡ç³»ç»Ÿï¼Œä½ å¯ä»¥åœ¨æµ‹è¯•æ­¥éª¤ä¹‹é—´ä¼ é€’æ•°æ®ã€åŠ¨æ€æ„å»ºè¯·æ±‚å†…å®¹ã€å®ç°æ•°æ®é©±åŠ¨æµ‹è¯•ã€‚

---

## ğŸ¯ å­¦ä¹ ç›®æ ‡

å®Œæˆæœ¬ç« åï¼Œä½ å°†èƒ½å¤Ÿï¼š
- å®šä¹‰å’Œä½¿ç”¨å„ç§ç±»å‹çš„å˜é‡
- ä½¿ç”¨æ¨¡æ¿è¯­æ³• `${variable}` å¼•ç”¨å˜é‡
- ç†è§£å˜é‡ä¼˜å…ˆçº§å’Œä½œç”¨åŸŸ
- ä½¿ç”¨å†…ç½®æ¨¡æ¿å‡½æ•°

---

## ğŸ“š æ ¸å¿ƒæ¦‚å¿µ

### å˜é‡æ¥æº

å˜é‡æŒ‰ä¼˜å…ˆçº§ä»é«˜åˆ°ä½æ’åºï¼š

1. **æ­¥éª¤å˜é‡** - é€šè¿‡ extractors æå–çš„å˜é‡
2. **å…¨å±€å˜é‡** - config.variables ä¸­å®šä¹‰
3. **Profileå˜é‡** - å½“å‰æ¿€æ´» profile ä¸­çš„å˜é‡
4. **ç¯å¢ƒå˜é‡** - ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼ˆé€šè¿‡å‰ç¼€è¿‡æ»¤ï¼‰

### å˜é‡å¼•ç”¨è¯­æ³•

```yaml
# åŸºæœ¬è¯­æ³•
url: "${base_url}/api/users"

# åµŒå¥—å¼•ç”¨
url: "${config.profiles.${env}.base_url}"

# é»˜è®¤å€¼
name: "${username:default_user}"
```

---

## âš™ï¸ YAML å…³é”®å­—å‚è€ƒ

| å…³é”®å­— | ç±»å‹ | ä½ç½® | æè¿° |
|-------|------|------|------|
| variables | object | config | å…¨å±€å˜é‡å®šä¹‰ |
| extractors | array | step | å˜é‡æå–å™¨åˆ—è¡¨ |
| variable_prefix | string | config | æ•°æ®é©±åŠ¨å˜é‡å‰ç¼€ |

### æå–å™¨å…³é”®å­—

| å…³é”®å­— | ç±»å‹ | å¿…å¡« | æè¿° |
|-------|------|------|------|
| name | string | âœ… | å˜é‡åç§° |
| type | string | âŒ | æå–ç±»å‹ï¼ˆjsonpath/regex/header/cookieï¼‰ |
| path | string | âœ… | æå–è·¯å¾„/è¡¨è¾¾å¼ |
| default | any | âŒ | é»˜è®¤å€¼ |

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šå…¨å±€å˜é‡å®šä¹‰

```yaml
name: "å…¨å±€å˜é‡ç¤ºä¾‹"
config:
  variables:
    api_version: "v2"
    timeout: 30
    debug: true
  profiles:
    dev:
      base_url: "http://dev.api.com"
      api_key: "dev_key_123"
    prod:
      base_url: "https://api.example.com"
      api_key: "prod_key_456"
  active_profile: "dev"

steps:
  - name: "ä½¿ç”¨å˜é‡"
    method: GET
    url: "${config.profiles.dev.base_url}/${api_version}/users"
    headers:
      X-API-Key: "${config.profiles.dev.api_key}"
```

### ç¤ºä¾‹2ï¼šä»å“åº”æå–å˜é‡

```yaml
steps:
  - name: "ç™»å½•è·å–Token"
    method: POST
    url: "${base_url}/auth/login"
    body:
      username: "admin"
      password: "password"
    extractors:
      - name: access_token
        type: jsonpath
        path: "$.data.access_token"
      - name: user_id
        type: jsonpath
        path: "$.data.user.id"
      - name: session_id
        type: header
        path: "X-Session-ID"

  - name: "ä½¿ç”¨æå–çš„å˜é‡"
    method: GET
    url: "${base_url}/users/${user_id}"
    headers:
      Authorization: "Bearer ${access_token}"
      X-Session-ID: "${session_id}"
```

### ç¤ºä¾‹3ï¼šæ­£åˆ™æå–

```yaml
extractors:
  - name: order_number
    type: regex
    path: "Order ID: (\\d+)"
    index: 1  # æ•è·ç»„ç´¢å¼•
  - name: total_amount
    type: regex
    pattern: "Total: \\$([\\d.]+)"
    group: 1
```

---

## ğŸ”§ å†…ç½®æ¨¡æ¿å‡½æ•°

| å‡½æ•° | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| `uuid()` | ç”Ÿæˆ UUID | `${uuid()}` |
| `timestamp()` | å½“å‰æ—¶é—´æˆ³ | `${timestamp()}` |
| `random_int(min,max)` | éšæœºæ•´æ•° | `${random_int(1,100)}` |
| `random_string(len)` | éšæœºå­—ç¬¦ä¸² | `${random_string(8)}` |
| `base64_encode(str)` | Base64 ç¼–ç  | `${base64_encode(text)}` |
| `md5(str)` | MD5 å“ˆå¸Œ | `${md5(password)}` |

```yaml
body:
  request_id: "${uuid()}"
  timestamp: "${timestamp()}"
  verification_code: "${random_int(100000,999999)}"
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å˜é‡åå¤§å°å†™æ•æ„Ÿ**ï¼š`${Token}` å’Œ `${token}` æ˜¯ä¸åŒå˜é‡
2. **æœªå®šä¹‰å˜é‡**ï¼šå¼•ç”¨æœªå®šä¹‰å˜é‡ä¼šä¿ç•™åŸå§‹å­—ç¬¦ä¸²
3. **å¾ªç¯å¼•ç”¨**ï¼šé¿å…å˜é‡ A å¼•ç”¨å˜é‡ Bï¼Œè€Œ B åˆå¼•ç”¨ A

---

## ğŸ”— ç›¸å…³èµ„æº

- [ä¸Šä¸€ç« ï¼šHTTPè¯·æ±‚](./01_HTTPè¯·æ±‚.md)
- [ä¸‹ä¸€ç« ï¼šéªŒè¯æ–­è¨€](./03_éªŒè¯æ–­è¨€.md)
- [ç¤ºä¾‹æ–‡ä»¶](../examples/03_å˜é‡å®šä¹‰ä½¿ç”¨.yaml)
