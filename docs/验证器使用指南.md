# Sisyphus API Engine - éªŒè¯å™¨ä½¿ç”¨æŒ‡å—

**ç‰ˆæœ¬**: v1.0
**æ›´æ–°æ—¥æœŸ**: 2026-02-02
**é€‚ç”¨æ¡†æ¶**: Sisyphus API Engine v2.0+

---

## ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [éªŒè¯å™¨åŸºç¡€](#éªŒè¯å™¨åŸºç¡€)
3. [æ¯”è¾ƒéªŒè¯å™¨](#æ¯”è¾ƒéªŒè¯å™¨)
4. [å­—ç¬¦ä¸²éªŒè¯å™¨](#å­—ç¬¦ä¸²éªŒè¯å™¨)
5. [é›†åˆéªŒè¯å™¨](#é›†åˆéªŒè¯å™¨)
6. [ç±»å‹éªŒè¯å™¨](#ç±»å‹éªŒè¯å™¨)
7. [é•¿åº¦éªŒè¯å™¨](#é•¿åº¦éªŒè¯å™¨)
8. [å…¶ä»–éªŒè¯å™¨](#å…¶ä»–éªŒè¯å™¨)
9. [é€»è¾‘è¿ç®—ç¬¦](#é€»è¾‘è¿ç®—ç¬¦)
10. [è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯](#è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯)
11. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
12. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æ¦‚è¿°

éªŒè¯å™¨(Validators)æ˜¯ Sisyphus API Engine çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€,ç”¨äºéªŒè¯ HTTP å“åº”æ•°æ®æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚æ¡†æ¶æä¾›äº† 20+ ç§å†…ç½®éªŒè¯å™¨,è¦†ç›–äº†å„ç§å¸¸è§éªŒè¯åœºæ™¯ã€‚

### éªŒè¯å™¨çš„å·¥ä½œåŸç†

1. **æå–å®é™…å€¼**: ä½¿ç”¨ JSONPath ä»å“åº”æ•°æ®ä¸­æå–å®é™…å€¼
2. **åº”ç”¨éªŒè¯è§„åˆ™**: ä½¿ç”¨å¯¹åº”çš„éªŒè¯å™¨å‡½æ•°æ¯”è¾ƒå®é™…å€¼å’ŒæœŸæœ›å€¼
3. **è¿”å›éªŒè¯ç»“æœ**: è¿”å›éªŒè¯ç»“æœ(passed/failed)å’Œé”™è¯¯æ¶ˆæ¯

### åŸºæœ¬è¯­æ³•

```yaml
validations:
  - type: <éªŒè¯å™¨ç±»å‹>
    path: <JSONPathè¡¨è¾¾å¼>
    expect: <æœŸæœ›å€¼>
    description: <éªŒè¯æè¿°>
    error_message: <è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯>  # å¯é€‰
```

---

## éªŒè¯å™¨åŸºç¡€

### å®Œæ•´çš„éªŒè¯è§„åˆ™ç»“æ„

```yaml
validations:
  - type: eq                    # éªŒè¯å™¨ç±»å‹(å¿…å¡«)
    path: "$.data.user.id"      # JSONPathè·¯å¾„(å¿…å¡«)
    expect: 123                 # æœŸæœ›å€¼(å¿…å¡«)
    description: "éªŒè¯ç”¨æˆ·ID"    # éªŒè¯æè¿°(æ¨è)
    error_message: "ç”¨æˆ·IDé”™è¯¯" # è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯(å¯é€‰)
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `type` | string | âœ… | éªŒè¯å™¨ç±»å‹(eq/gt/contains/regexç­‰) |
| `path` | string | âœ… | JSONPathè¡¨è¾¾å¼,æå–è¦éªŒè¯çš„å­—æ®µ |
| `expect` | any | âœ… | æœŸæœ›å€¼,ç±»å‹å–å†³äºéªŒè¯å™¨ |
| `description` | string | âŒ | éªŒè¯æè¿°,ç”¨äºæŠ¥å‘Šå’Œæ—¥å¿— |
| `error_message` | string | âŒ | è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯,éªŒè¯å¤±è´¥æ—¶æ˜¾ç¤º |

---

## æ¯”è¾ƒéªŒè¯å™¨

### 1. eq - ç›¸ç­‰éªŒè¯

éªŒè¯å®é™…å€¼æ˜¯å¦ç­‰äºæœŸæœ›å€¼ã€‚

**è¯­æ³•**:
```yaml
- type: eq
  path: "$.field"
  expect: <æœŸæœ›å€¼>
```

**æ”¯æŒç±»å‹**: å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ã€nullã€å¯¹è±¡ã€æ•°ç»„

**ç¤ºä¾‹**:
```yaml
# éªŒè¯å­—ç¬¦ä¸²ç›¸ç­‰
- type: eq
  path: "$.status"
  expect: "success"
  description: "éªŒè¯çŠ¶æ€ä¸ºæˆåŠŸ"

# éªŒè¯æ•°å­—ç›¸ç­‰
- type: eq
  path: "$.data.user.id"
  expect: 12345
  description: "éªŒè¯ç”¨æˆ·ID"

# éªŒè¯å¸ƒå°”å€¼
- type: eq
  path: "$.data.is_active"
  expect: true
  description: "éªŒè¯ç”¨æˆ·æ˜¯å¦æ¿€æ´»"
```

### 2. ne - ä¸ç›¸ç­‰éªŒè¯

éªŒè¯å®é™…å€¼æ˜¯å¦ä¸ç­‰äºæœŸæœ›å€¼ã€‚

**è¯­æ³•**:
```yaml
- type: ne
  path: "$.field"
  expect: <æœŸæœ›å€¼>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯çŠ¶æ€ç ä¸æ˜¯404
- type: ne
  path: "$.code"
  expect: 404
  description: "éªŒè¯ä¸æ˜¯404é”™è¯¯"

# éªŒè¯å­—æ®µä¸ä¸ºç©º
- type: ne
  path: "$.message"
  expect: ""
  description: "éªŒè¯æ¶ˆæ¯ä¸ä¸ºç©º"
```

### 3. gt - å¤§äºéªŒè¯

éªŒè¯å®é™…å€¼æ˜¯å¦å¤§äºæœŸæœ›å€¼ã€‚

**è¯­æ³•**:
```yaml
- type: gt
  path: "$.field"
  expect: <æ•°å­—>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯å¹´é¾„å¤§äº18
- type: gt
  path: "$.data.age"
  expect: 18
  description: "éªŒè¯å¹´é¾„å¤§äº18å²"

# éªŒè¯æ•°é‡å¤§äº0
- type: gt
  path: "$.data.items.length()"
  expect: 0
  description: "éªŒè¯åˆ—è¡¨éç©º"
```

### 4. lt - å°äºéªŒè¯

éªŒè¯å®é™…å€¼æ˜¯å¦å°äºæœŸæœ›å€¼ã€‚

**è¯­æ³•**:
```yaml
- type: lt
  path: "$.field"
  expect: <æ•°å­—>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯å»¶è¿Ÿå°äº100ms
- type: lt
  path: "$.latency"
  expect: 100
  description: "éªŒè¯æ¥å£å»¶è¿Ÿ"

# éªŒè¯é”™è¯¯æ¬¡æ•°å°äº3
- type: lt
  path: "$.error_count"
  expect: 3
  description: "éªŒè¯é”™è¯¯æ¬¡æ•°"
```

### 5. ge - å¤§äºç­‰äºéªŒè¯

éªŒè¯å®é™…å€¼æ˜¯å¦å¤§äºæˆ–ç­‰äºæœŸæœ›å€¼ã€‚

**è¯­æ³•**:
```yaml
- type: ge
  path: "$.field"
  expect: <æ•°å­—>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯åº“å­˜å¤§äºç­‰äº10
- type: ge
  path: "$.data.stock"
  expect: 10
  description: "éªŒè¯åº“å­˜å……è¶³"

# éªŒè¯è¯„åˆ†å¤§äºç­‰äº4.0
- type: ge
  path: "$.rating"
  expect: 4.0
  description: "éªŒè¯é«˜è¯„åˆ†"
```

### 6. le - å°äºç­‰äºéªŒè¯

éªŒè¯å®é™…å€¼æ˜¯å¦å°äºæˆ–ç­‰äºæœŸæœ›å€¼ã€‚

**è¯­æ³•**:
```yaml
- type: le
  path: "$.field"
  expect: <æ•°å­—>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯ä»·æ ¼å°äºç­‰äº1000
- type: le
  path: "$.data.price"
  expect: 1000
  description: "éªŒè¯ä»·æ ¼åœ¨é¢„ç®—å†…"

# éªŒè¯å¹¶å‘æ•°å°äºç­‰äº100
- type: le
  path: "$.concurrent_users"
  expect: 100
  description: "éªŒè¯å¹¶å‘é™åˆ¶"
```

---

## å­—ç¬¦ä¸²éªŒè¯å™¨

### 1. contains - åŒ…å«éªŒè¯

éªŒè¯å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æŒ‡å®šå­ä¸²,æˆ–æ•°ç»„æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ ã€‚

**è¯­æ³•**:
```yaml
- type: contains
  path: "$.field"
  expect: <å­ä¸²æˆ–å…ƒç´ >
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯æ¶ˆæ¯åŒ…å«"æˆåŠŸ"
- type: contains
  path: "$.message"
  expect: "æˆåŠŸ"
  description: "éªŒè¯æ¶ˆæ¯å†…å®¹"

# éªŒè¯æ•°ç»„åŒ…å«å…ƒç´ 
- type: contains
  path: "$.data.tags"
  expect: "python"
  description: "éªŒè¯æ ‡ç­¾åŒ…å«Python"

# éªŒè¯å­—å…¸åŒ…å«é”®
- type: contains
  path: "$.data"
  expect: "user_id"
  description: "éªŒè¯åŒ…å«user_idå­—æ®µ"
```

### 2. not_contains - ä¸åŒ…å«éªŒè¯

éªŒè¯å­—ç¬¦ä¸²æ˜¯å¦ä¸åŒ…å«æŒ‡å®šå­ä¸²,æˆ–æ•°ç»„æ˜¯å¦ä¸åŒ…å«æŒ‡å®šå…ƒç´ ã€‚

**è¯­æ³•**:
```yaml
- type: not_contains
  path: "$.field"
  expect: <å­ä¸²æˆ–å…ƒç´ >
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯æ¶ˆæ¯ä¸åŒ…å«"é”™è¯¯"
- type: not_contains
  path: "$.message"
  expect: "é”™è¯¯"
  description: "éªŒè¯æ— é”™è¯¯ä¿¡æ¯"

# éªŒè¯ä¸åŒ…å«æ•æ„Ÿè¯
- type: not_contains
  path: "$.content"
  expect: "password"
  description: "éªŒè¯å†…å®¹å®‰å…¨"

# éªŒè¯ä¸åŒ…å«HTMLæ ‡ç­¾
- type: not_contains
  path: "$.user_input"
  expect: "<script>"
  description: "éªŒè¯XSSé˜²æŠ¤"
```

### 3. starts_with - å‰ç¼€éªŒè¯

éªŒè¯å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŒ‡å®šå‰ç¼€å¼€å¤´ã€‚

**è¯­æ³•**:
```yaml
- type: starts_with
  path: "$.field"
  expect: <å‰ç¼€å­—ç¬¦ä¸²>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯URLåè®®
- type: starts_with
  path: "$.data.url"
  expect: "https://"
  description: "éªŒè¯ä½¿ç”¨HTTPSåè®®"

# éªŒè¯æ–‡ä»¶è·¯å¾„
- type: starts_with
  path: "$.data.file_path"
  expect: "/var/log/"
  description: "éªŒè¯æ—¥å¿—æ–‡ä»¶è·¯å¾„"

# éªŒè¯JWTç¼–ç 
- type: starts_with
  path: "$.token"
  expect: "eyJ"
  description: "éªŒè¯JWTç¼–ç æ ¼å¼"
```

### 4. ends_with - åç¼€éªŒè¯

éªŒè¯å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŒ‡å®šåç¼€ç»“å°¾ã€‚

**è¯­æ³•**:
```yaml
- type: ends_with
  path: "$.field"
  expect: <åç¼€å­—ç¬¦ä¸²>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯æ–‡ä»¶æ‰©å±•å
- type: ends_with
  path: "$.data.filename"
  expect: ".pdf"
  description: "éªŒè¯PDFæ–‡ä»¶"

# éªŒè¯åŸŸååç¼€
- type: ends_with
  path: "$.data.domain"
  expect: ".com"
  description: "éªŒè¯å•†ä¸šåŸŸå"

# éªŒè¯URLæŸ¥è¯¢å‚æ•°
- type: ends_with
  path: "$.request_url"
  expect: "page=2"
  description: "éªŒè¯åˆ†é¡µå‚æ•°"
```

### 5. regex - æ­£åˆ™è¡¨è¾¾å¼éªŒè¯

éªŒè¯å­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…æŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€‚

**è¯­æ³•**:
```yaml
- type: regex
  path: "$.field"
  expect: <æ­£åˆ™è¡¨è¾¾å¼>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯é‚®ç®±æ ¼å¼
- type: regex
  path: "$.data.email"
  expect: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
  description: "éªŒè¯é‚®ç®±æ ¼å¼"

# éªŒè¯æ‰‹æœºå·
- type: regex
  path: "$.data.phone"
  expect: "^1[3-9]\\d{9}$"
  description: "éªŒè¯ä¸­å›½æ‰‹æœºå·"

# éªŒè¯IPåœ°å€
- type: regex
  path: "$.data.ip"
  expect: "^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$"
  description: "éªŒè¯IPv4åœ°å€"

# éªŒè¯æ—¥æœŸæ ¼å¼
- type: regex
  path: "$.data.date"
  expect: "^\\d{4}-\\d{2}-\\d{2}$"
  description: "éªŒè¯æ—¥æœŸæ ¼å¼(YYYY-MM-DD)"
```

**æ³¨æ„**: æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ Python çš„ `re.search()` æ–¹æ³•,ä¸éœ€è¦å®Œå…¨åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²ã€‚

---

## é›†åˆéªŒè¯å™¨

### 1. in_list - åŒ…å«äºåˆ—è¡¨éªŒè¯

éªŒè¯å€¼æ˜¯å¦åœ¨æŒ‡å®šçš„åˆ—è¡¨ä¸­ã€‚

**è¯­æ³•**:
```yaml
- type: in_list
  path: "$.field"
  expect: [<å€¼1>, <å€¼2>, ...]
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯çŠ¶æ€å€¼åˆæ³•
- type: in_list
  path: "$.status"
  expect: ["pending", "processing", "completed"]
  description: "éªŒè¯çŠ¶æ€åœ¨å…è®¸èŒƒå›´å†…"

# éªŒè¯HTTPçŠ¶æ€ç 
- type: in_list
  path: "$.status_code"
  expect: [200, 201, 204]
  description: "éªŒè¯æˆåŠŸçŠ¶æ€ç "

# éªŒè¯ç”¨æˆ·è§’è‰²
- type: in_list
  path: "$.user.role"
  expect: ["admin", "user", "guest"]
  description: "éªŒè¯ç”¨æˆ·è§’è‰²åˆæ³•"
```

### 2. not_in_list - ä¸åŒ…å«äºåˆ—è¡¨éªŒè¯

éªŒè¯å€¼æ˜¯å¦ä¸åœ¨æŒ‡å®šçš„åˆ—è¡¨ä¸­ã€‚

**è¯­æ³•**:
```yaml
- type: not_in_list
  path: "$.field"
  expect: [<å€¼1>, <å€¼2>, ...]
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯ä¸åœ¨é»‘åå•ä¸­
- type: not_in_list
  path: "$.username"
  expect: ["admin", "root", "system"]
  description: "éªŒè¯ç”¨æˆ·åä¸ä½¿ç”¨ç³»ç»Ÿä¿ç•™å"

# éªŒè¯ä¸ä½¿ç”¨è¢«ç¦ç”¨çš„å¯†ç 
- type: not_in_list
  path: "$.password"
  expect: ["123456", "password", "qwerty"]
  description: "éªŒè¯ä¸ä½¿ç”¨å¼±å¯†ç "
```

---

## ç±»å‹éªŒè¯å™¨

### 1. type - ç±»å‹éªŒè¯

éªŒè¯å€¼çš„æ•°æ®ç±»å‹æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚

**è¯­æ³•**:
```yaml
- type: type
  path: "$.field"
  expect: <ç±»å‹åç§°>
```

**æ”¯æŒçš„ç±»å‹**: `str`, `int`, `float`, `bool`, `list`, `dict`, `null`

**ç¤ºä¾‹**:
```yaml
# éªŒè¯æ˜¯å­—ç¬¦ä¸²
- type: type
  path: "$.data.name"
  expect: str
  description: "éªŒè¯å§“åä¸ºå­—ç¬¦ä¸²"

# éªŒè¯æ˜¯æ•´æ•°
- type: type
  path: "$.data.count"
  expect: int
  description: "éªŒè¯æ•°é‡ä¸ºæ•´æ•°"

# éªŒè¯æ˜¯å¸ƒå°”å€¼
- type: type
  path: "$.data.is_active"
  expect: bool
  description: "éªŒè¯æ¿€æ´»çŠ¶æ€ä¸ºå¸ƒå°”å€¼"

# éªŒè¯æ˜¯æ•°ç»„
- type: type
  path: "$.data.items"
  expect: list
  description: "éªŒè¯é¡¹ç›®ä¸ºæ•°ç»„"

# éªŒè¯æ˜¯å¯¹è±¡
- type: type
  path: "$.data.user"
  expect: dict
  description: "éªŒè¯ç”¨æˆ·ä¿¡æ¯ä¸ºå¯¹è±¡"

# éªŒè¯ä¸ºnull
- type: type
  path: "$.data.deleted_at"
  expect: null
  description: "éªŒè¯åˆ é™¤æ—¶é—´ä¸ºnull"
```

### 2. is_empty - ç©ºå€¼éªŒè¯

éªŒè¯å€¼æ˜¯å¦ä¸ºç©º(ç©ºå­—ç¬¦ä¸²ã€ç©ºæ•°ç»„ã€ç©ºå­—å…¸æˆ–null)ã€‚

**è¯­æ³•**:
```yaml
# éªŒè¯ä¸ºç©º
- type: is_empty
  path: "$.field"
  expect: true

# éªŒè¯éç©º
- type: is_empty
  path: "$.field"
  expect: false
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯é”™è¯¯æ¶ˆæ¯ä¸ºç©º
- type: is_empty
  path: "$.error_message"
  expect: true
  description: "éªŒè¯æ²¡æœ‰é”™è¯¯æ¶ˆæ¯"

# éªŒè¯åˆ—è¡¨éç©º
- type: is_empty
  path: "$.data.items"
  expect: false
  description: "éªŒè¯åˆ—è¡¨ä¸ä¸ºç©º"
```

### 3. is_null - nullå€¼éªŒè¯

éªŒè¯å€¼æ˜¯å¦ä¸ºnullã€‚

**è¯­æ³•**:
```yaml
# éªŒè¯ä¸ºnull
- type: is_null
  path: "$.field"
  expect: true

# éªŒè¯ä¸ä¸ºnull
- type: is_null
  path: "$.field"
  expect: false
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯åˆ é™¤æ—¶é—´ä¸ºnull
- type: is_null
  path: "$.data.deleted_at"
  expect: true
  description: "éªŒè¯è®°å½•æœªè¢«åˆ é™¤"

# éªŒè¯åˆ›å»ºæ—¶é—´ä¸ä¸ºnull
- type: is_null
  path: "$.data.created_at"
  expect: false
  description: "éªŒè¯åˆ›å»ºæ—¶é—´å­˜åœ¨"
```

### 4. exists - å­˜åœ¨æ€§éªŒè¯

éªŒè¯å€¼æ˜¯å¦å­˜åœ¨(énullä¸”éç©º)ã€‚

**è¯­æ³•**:
```yaml
# éªŒè¯å­˜åœ¨
- type: exists
  path: "$.field"
  expect: true

# éªŒè¯ä¸å­˜åœ¨
- type: exists
  path: "$.field"
  expect: false
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯ç”¨æˆ·IDå­˜åœ¨
- type: exists
  path: "$.data.user_id"
  expect: true
  description: "éªŒè¯ç”¨æˆ·IDå­˜åœ¨"

# éªŒè¯é”™è¯¯ä¿¡æ¯ä¸å­˜åœ¨
- type: exists
  path: "$.error"
  expect: false
  description: "éªŒè¯æ— é”™è¯¯"
```

---

## é•¿åº¦éªŒè¯å™¨

### 1. length_eq - é•¿åº¦ç›¸ç­‰éªŒè¯

éªŒè¯å­—ç¬¦ä¸²ã€æ•°ç»„æˆ–å­—å…¸çš„é•¿åº¦æ˜¯å¦ç­‰äºæœŸæœ›å€¼ã€‚

**è¯­æ³•**:
```yaml
- type: length_eq
  path: "$.field"
  expect: <é•¿åº¦å€¼>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯å­—ç¬¦ä¸²é•¿åº¦
- type: length_eq
  path: "$.data.username"
  expect: 8
  description: "éªŒè¯ç”¨æˆ·åé•¿åº¦ä¸º8"

# éªŒè¯æ•°ç»„é•¿åº¦
- type: length_eq
  path: "$.data.items"
  expect: 10
  description: "éªŒè¯åˆ—è¡¨åŒ…å«10ä¸ªå…ƒç´ "

# éªŒè¯æ‰‹æœºå·é•¿åº¦(11ä½)
- type: length_eq
  path: "$.data.phone"
  expect: 11
  description: "éªŒè¯æ‰‹æœºå·é•¿åº¦"
```

### 2. length_gt - é•¿åº¦å¤§äºéªŒè¯

éªŒè¯é•¿åº¦æ˜¯å¦å¤§äºæœŸæœ›å€¼ã€‚

**è¯­æ³•**:
```yaml
- type: length_gt
  path: "$.field"
  expect: <é•¿åº¦å€¼>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯å¯†ç é•¿åº¦å¤§äº8
- type: length_gt
  path: "$.data.password"
  expect: 8
  description: "éªŒè¯å¯†ç å¼ºåº¦"

# éªŒè¯ç»“æœæ•°é‡å¤§äº0
- type: length_gt
  path: "$.data.results"
  expect: 0
  description: "éªŒè¯æœ‰æœç´¢ç»“æœ"
```

### 3. length_lt - é•¿åº¦å°äºéªŒè¯

éªŒè¯é•¿åº¦æ˜¯å¦å°äºæœŸæœ›å€¼ã€‚

**è¯­æ³•**:
```yaml
- type: length_lt
  path: "$.field"
  expect: <é•¿åº¦å€¼>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯æè¿°é•¿åº¦å°äº200
- type: length_lt
  path: "$.data.description"
  expect: 200
  description: "éªŒè¯æè¿°é•¿åº¦é™åˆ¶"

# éªŒè¯æ ‡ç­¾æ•°é‡å°äº5
- type: length_lt
  path: "$.data.tags"
  expect: 5
  description: "éªŒè¯æ ‡ç­¾æ•°é‡é™åˆ¶"
```

---

## å…¶ä»–éªŒè¯å™¨

### 1. between - èŒƒå›´éªŒè¯

éªŒè¯æ•°å€¼æ˜¯å¦åœ¨æŒ‡å®šèŒƒå›´å†…(åŒ…å«è¾¹ç•Œå€¼)ã€‚

**è¯­æ³•**:
```yaml
- type: between
  path: "$.field"
  expect: [<æœ€å°å€¼>, <æœ€å¤§å€¼>]
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯å¹´é¾„åœ¨18-65ä¹‹é—´
- type: between
  path: "$.data.age"
  expect: [18, 65]
  description: "éªŒè¯å¹´é¾„åœ¨åˆæ³•èŒƒå›´å†…"

# éªŒè¯è¯„åˆ†åœ¨0-100ä¹‹é—´
- type: between
  path: "$.data.score"
  expect: [0, 100]
  description: "éªŒè¯åˆ†æ•°èŒƒå›´"

# éªŒè¯æ¸©åº¦åœ¨-10åˆ°40ä¹‹é—´
- type: between
  path: "$.sensor.temperature"
  expect: [-10, 40]
  description: "éªŒè¯æ¸©åº¦èŒƒå›´"
```

### 2. status_code - HTTPçŠ¶æ€ç éªŒè¯

ä¸“é—¨ç”¨äºéªŒè¯HTTPçŠ¶æ€ç ,æ”¯æŒèŒƒå›´æ¨¡å¼(å¦‚"2xx")ã€‚

**è¯­æ³•**:
```yaml
- type: status_code
  path: "$.status_code"
  expect: <çŠ¶æ€ç æˆ–èŒƒå›´>
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯å…·ä½“çŠ¶æ€ç 
- type: status_code
  path: "$.status_code"
  expect: 200
  description: "éªŒè¯HTTP 200çŠ¶æ€ç "

# éªŒè¯2xxæˆåŠŸçŠ¶æ€ç 
- type: status_code
  path: "$.status_code"
  expect: "2xx"
  description: "éªŒè¯2xxæˆåŠŸçŠ¶æ€"

# éªŒè¯4xxå®¢æˆ·ç«¯é”™è¯¯
- type: status_code
  path: "$.status_code"
  expect: "4xx"
  description: "éªŒè¯4xxå®¢æˆ·ç«¯é”™è¯¯"

# éªŒè¯5xxæœåŠ¡å™¨é”™è¯¯
- type: status_code
  path: "$.status_code"
  expect: "5xx"
  description: "éªŒè¯5xxæœåŠ¡å™¨é”™è¯¯"
```

---

## é€»è¾‘è¿ç®—ç¬¦

### 1. and - é€»è¾‘ä¸

æ‰€æœ‰å­éªŒè¯éƒ½å¿…é¡»é€šè¿‡ã€‚

**è¯­æ³•**:
```yaml
- type: and
  sub_validations:
    - <éªŒè¯è§„åˆ™1>
    - <éªŒè¯è§„åˆ™2>
    - ...
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯ç”¨æˆ·æ—¢æ˜¯æ¿€æ´»çŠ¶æ€åˆæ˜¯VIP
- type: and
  sub_validations:
    - type: eq
      path: "$.user.is_active"
      expect: true
    - type: eq
      path: "$.user.is_vip"
      expect: true
  description: "éªŒè¯ç”¨æˆ·ä¸ºæ¿€æ´»çš„VIP"
  error_message: "ç”¨æˆ·å¿…é¡»æ˜¯æ¿€æ´»çš„VIPä¼šå‘˜"

# å¤æ‚éªŒè¯:ä»·æ ¼å¤§äº0ä¸”å°äº1000
- type: and
  sub_validations:
    - type: gt
      path: "$.price"
      expect: 0
    - type: lt
      path: "$.price"
      expect: 1000
  description: "éªŒè¯ä»·æ ¼åœ¨0-1000ä¹‹é—´"
```

### 2. or - é€»è¾‘æˆ–

è‡³å°‘æœ‰ä¸€ä¸ªå­éªŒè¯é€šè¿‡å³å¯ã€‚

**è¯­æ³•**:
```yaml
- type: or
  sub_validations:
    - <éªŒè¯è§„åˆ™1>
    - <éªŒè¯è§„åˆ™2>
    - ...
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯ç”¨æˆ·æ˜¯adminæˆ–root
- type: or
  sub_validations:
    - type: eq
      path: "$.user.role"
      expect: "admin"
    - type: eq
      path: "$.user.role"
      expect: "root"
  description: "éªŒè¯ç®¡ç†å‘˜æƒé™"

# éªŒè¯é‚®ç®±æˆ–æ‰‹æœºå·è‡³å°‘æœ‰ä¸€ä¸ª
- type: or
  sub_validations:
    - type: exists
      path: "$.user.email"
      expect: true
    - type: exists
      path: "$.user.phone"
      expect: true
  description: "éªŒè¯è‡³å°‘æœ‰è”ç³»æ–¹å¼"
```

### 3. not - é€»è¾‘é

æ‰€æœ‰å­éªŒè¯éƒ½å¿…é¡»å¤±è´¥ã€‚

**è¯­æ³•**:
```yaml
- type: not
  sub_validations:
    - <éªŒè¯è§„åˆ™1>
    - <éªŒè¯è§„åˆ™2>
    - ...
```

**ç¤ºä¾‹**:
```yaml
# éªŒè¯çŠ¶æ€ä¸æ˜¯"failed"ä¹Ÿä¸æ˜¯"error"
- type: not
  sub_validations:
    - type: eq
      path: "$.status"
      expect: "failed"
    - type: eq
      path: "$.status"
      expect: "error"
  description: "éªŒè¯çŠ¶æ€ä¸æ˜¯å¤±è´¥æˆ–é”™è¯¯"

# éªŒè¯ç”¨æˆ·ä¸åœ¨é»‘åå•ä¸­
- type: not
  sub_validations:
    - type: in_list
      path: "$.username"
      expect: ["admin", "root", "system"]
  description: "éªŒè¯ç”¨æˆ·åä¸åœ¨ç³»ç»Ÿä¿ç•™åå•"
```

---

## è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯

ä» v2.0 å¼€å§‹,æ‰€æœ‰éªŒè¯å™¨éƒ½æ”¯æŒè‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯ã€‚

### åŸºæœ¬ç”¨æ³•

```yaml
validations:
  - type: eq
    path: "$.code"
    expect: 1
    error_message: "âŒ ä¸šåŠ¡ç é”™è¯¯: æœŸæœ›å€¼ä¸º1ï¼Œä½†å®é™…ä¸º${actual}ã€‚è¯·æ£€æŸ¥åç«¯é€»è¾‘ã€‚"
    description: "éªŒè¯ä¸šåŠ¡ç ä¸º1"
```

### åœ¨é”™è¯¯æ¶ˆæ¯ä¸­ä½¿ç”¨å˜é‡

é”™è¯¯æ¶ˆæ¯ä¸­å¯ä»¥ä½¿ç”¨å ä½ç¬¦:
- `${actual}`: å®é™…å€¼
- `${expected}`: æœŸæœ›å€¼
- `${path}`: JSONPathè·¯å¾„

```yaml
validations:
  - type: between
    path: "$.data.age"
    expect: [18, 65]
    error_message: "âš ï¸ å¹´é¾„ä¸ç¬¦åˆè¦æ±‚: å®é™…å¹´é¾„${actual}å²,è¦æ±‚åœ¨18-65å²ä¹‹é—´ã€‚"
    description: "éªŒè¯å¹´é¾„èŒƒå›´"

  - type: regex
    path: "$.data.email"
    expect: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
    error_message: "ğŸ“§ é‚®ç®±æ ¼å¼é”™è¯¯: '${actual}' ä¸æ˜¯æœ‰æ•ˆçš„é‚®ç®±åœ°å€ã€‚"
    description: "éªŒè¯é‚®ç®±æ ¼å¼"
```

### é€»è¾‘è¿ç®—ç¬¦ä¸­çš„è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯

```yaml
validations:
  - type: and
    sub_validations:
      - type: eq
        path: "$.user.is_active"
        expect: true
      - type: eq
        path: "$.user.email_verified"
        expect: true
    error_message: "âŒ è´¦æˆ·çŠ¶æ€éªŒè¯å¤±è´¥: è´¦æˆ·å¿…é¡»æ˜¯æ¿€æ´»çŠ¶æ€ä¸”é‚®ç®±å·²éªŒè¯ã€‚"
    description: "éªŒè¯è´¦æˆ·çŠ¶æ€"
```

### ä½•æ—¶ä½¿ç”¨è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯

**æ¨èä½¿ç”¨è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯çš„åœºæ™¯**:
1. éœ€è¦å‘ç”¨æˆ·å±•ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
2. é”™è¯¯æ¶ˆæ¯éœ€è¦åŒ…å«ä¸šåŠ¡ä¸Šä¸‹æ–‡
3. éœ€è¦æä¾›é”™è¯¯ä¿®å¤å»ºè®®
4. å¤šè¯­è¨€æµ‹è¯•ç¯å¢ƒ

**ä½¿ç”¨é»˜è®¤é”™è¯¯æ¶ˆæ¯çš„åœºæ™¯**:
1. å¿«é€ŸåŸå‹å¼€å‘
2. å†…éƒ¨æµ‹è¯•ç”¨ä¾‹
3. é”™è¯¯å«ä¹‰æ˜ç¡®çš„ç®€å•éªŒè¯

---

## æœ€ä½³å®è·µ

### 1. éªŒè¯å™¨é€‰æ‹©å»ºè®®

**æ ¹æ®æ•°æ®ç±»å‹é€‰æ‹©éªŒè¯å™¨**:
- æ•°å€¼æ¯”è¾ƒ: ä½¿ç”¨ `gt`/`lt`/`ge`/`le`/`between`
- å­—ç¬¦ä¸²å†…å®¹: ä½¿ç”¨ `contains`/`not_contains`/`starts_with`/`ends_with`
- å¤æ‚æ ¼å¼: ä½¿ç”¨ `regex`
- æšä¸¾å€¼: ä½¿ç”¨ `in_list`
- ç±»å‹æ£€æŸ¥: ä½¿ç”¨ `type`
- å­˜åœ¨æ€§æ£€æŸ¥: ä½¿ç”¨ `exists`/`is_null`

### 2. éªŒè¯é¡ºåºå»ºè®®

æ¨èéªŒè¯é¡ºåº:
```yaml
validations:
  # 1. å…ˆéªŒè¯çŠ¶æ€ç (æœ€å…³é”®)
  - type: status_code
    path: "$.status_code"
    expect: 200

  # 2. å†éªŒè¯ä¸šåŠ¡ç 
  - type: eq
    path: "$.code"
    expect: 1

  # 3. ç„¶åéªŒè¯æ ¸å¿ƒæ•°æ®
  - type: exists
    path: "$.data"
    expect: true

  # 4. æœ€åéªŒè¯è¯¦ç»†å­—æ®µ
  - type: eq
    path: "$.data.user.id"
    expect: 123
```

### 3. éªŒè¯æè¿°ç¼–å†™å»ºè®®

**å¥½çš„æè¿°**:
```yaml
# âœ… æ¸…æ™°è¯´æ˜éªŒè¯ç›®çš„
- description: "éªŒè¯ç”¨æˆ·IDä¸º123"

# âœ… åŒ…å«ä¸šåŠ¡å«ä¹‰
- description: "éªŒè¯è®¢å•çŠ¶æ€ä¸ºå·²æ”¯ä»˜"

# âœ… è¯´æ˜éªŒè¯æ¡ä»¶
- description: "éªŒè¯å¯†ç é•¿åº¦å¤§äº8ä¸”åŒ…å«æ•°å­—"
```

**ä¸å¥½çš„æè¿°**:
```yaml
# âŒ è¿‡äºç®€å•
- description: "éªŒè¯"

# âŒ æ— æ„ä¹‰
- description: "æµ‹è¯•"

# âŒ é‡å¤éªŒè¯å™¨åç§°
- description: "éªŒè¯ç›¸ç­‰"
```

### 4. æ€§èƒ½ä¼˜åŒ–å»ºè®®

**ä½¿ç”¨é«˜æ•ˆçš„éªŒè¯å™¨**:
```yaml
# âœ… æ¨è: ä½¿ç”¨existså¿«é€Ÿæ£€æŸ¥
- type: exists
  path: "$.data"
  expect: true

# âŒ ä¸æ¨è: ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€æŸ¥å­˜åœ¨æ€§
- type: regex
  path: "$.data"
  expect: ".+"
```

**é¿å…å†—ä½™éªŒè¯**:
```yaml
# âŒ å†—ä½™: typeéªŒè¯å·²åŒ…å«existsæ£€æŸ¥
- type: exists
  path: "$.data.user"
  expect: true
- type: type
  path: "$.data.user"
  expect: dict

# âœ… æ¨è: åªä½¿ç”¨typeéªŒè¯
- type: type
  path: "$.data.user"
  expect: dict
```

### 5. é”™è¯¯å¤„ç†æœ€ä½³å®è·µ

**æä¾›æœ‰ç”¨çš„é”™è¯¯ä¿¡æ¯**:
```yaml
# âœ… å¥½çš„é”™è¯¯æ¶ˆæ¯
- error_message: |
  âŒ è®¢å•é‡‘é¢éªŒè¯å¤±è´¥:
  - å®é™…é‡‘é¢: ${actual}å…ƒ
  - æœŸæœ›èŒƒå›´: 100-10000å…ƒ
  - å»ºè®®: è¯·æ£€æŸ¥è®¢å•é‡‘é¢æ˜¯å¦åœ¨å…è®¸èŒƒå›´å†…

# âŒ æ— ç”¨çš„é”™è¯¯æ¶ˆæ¯
- error_message: "éªŒè¯å¤±è´¥"
```

**ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦ç»„åˆéªŒè¯**:
```yaml
# âœ… æ¨è: ä½¿ç”¨andè¿ç®—ç¬¦
- type: and
  sub_validations:
    - type: ge
      path: "$.age"
      expect: 18
    - type: le
      path: "$.age"
      expect: 65
  error_message: "å¹´é¾„å¿…é¡»åœ¨18-65å²ä¹‹é—´"

# âŒ ä¸æ¨è: åˆ†å¼€éªŒè¯ä¼šæŠ¥å‘Šä¸¤æ¬¡é”™è¯¯
- type: ge
  path: "$.age"
  expect: 18
- type: le
  path: "$.age"
  expect: 65
```

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆéªŒè¯å™¨å¤±è´¥äº†ä½†æˆ‘çœ‹ä¸åˆ°é”™è¯¯è¯¦æƒ…?

**A**: ä½¿ç”¨ `-v` å‚æ•°è¿è¡Œæµ‹è¯•,æŸ¥çœ‹è¯¦ç»†è¾“å‡º:
```bash
sisyphus --cases test.yaml -v
```

### Q2: å¦‚ä½•éªŒè¯æ•°ç»„ä¸­çš„æŸä¸ªå…ƒç´ ?

**A**: ä½¿ç”¨JSONPathæ•°ç»„ç´¢å¼•:
```yaml
# éªŒè¯ç¬¬ä¸€ä¸ªå…ƒç´ 
- type: eq
  path: "$.items[0].name"
  expect: "Alice"

# éªŒè¯æœ€åä¸€ä¸ªå…ƒç´ 
- type: eq
  path: "$.items[-1].name"
  expect: "Bob"

# éªŒè¯æ‰€æœ‰å…ƒç´ (ä½¿ç”¨é€šé…ç¬¦)
- type: contains
  path: "$.items[*].status"
  expect: "active"
```

### Q3: å¦‚ä½•éªŒè¯æ•°ç»„é•¿åº¦?

**A**: ä½¿ç”¨JSONPathå‡½æ•°æˆ–lengthéªŒè¯å™¨:
```yaml
# æ–¹å¼1: ä½¿ç”¨length()å‡½æ•°
- type: eq
  path: "$.items.length()"
  expect: 10

# æ–¹å¼2: ç›´æ¥ä½¿ç”¨length_eqéªŒè¯å™¨
- type: length_eq
  path: "$.items"
  expect: 10
```

### Q4: æ­£åˆ™è¡¨è¾¾å¼éªŒè¯ä¸ç”Ÿæ•ˆ?

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹:
1. ç¡®ä¿è·¯å¾„æ­£ç¡®,æå–åˆ°çš„æ˜¯å­—ç¬¦ä¸²
2. æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨Pythonè¯­æ³•,å¯èƒ½éœ€è¦è½¬ä¹‰åæ–œæ 
3. ä½¿ç”¨ `re.search()` è¿›è¡Œéƒ¨åˆ†åŒ¹é…,ä¸éœ€è¦å®Œå…¨åŒ¹é…

```yaml
# âœ… æ­£ç¡®: è½¬ä¹‰åæ–œæ 
- type: regex
  path: "$.email"
  expect: "^[a-z]+@[a-z]+\\.[a-z]+$"

# âŒ é”™è¯¯: æœªè½¬ä¹‰
- type: regex
  path: "$.email"
  expect: "^[a-z]+@[a-z]+\.[a-z]+$"
```

### Q5: å¦‚ä½•éªŒè¯æµ®ç‚¹æ•°ç›¸ç­‰?

**A**: é¿å…ä½¿ç”¨eqéªŒè¯æµ®ç‚¹æ•°,æ”¹ç”¨èŒƒå›´éªŒè¯:
```yaml
# âŒ ä¸æ¨è: æµ®ç‚¹æ•°ç²¾ç¡®æ¯”è¾ƒ
- type: eq
  path: "$.price"
  expect: 99.99

# âœ… æ¨è: èŒƒå›´éªŒè¯
- type: between
  path: "$.price"
  expect: [99.98, 100.00]
```

### Q6: å¦‚ä½•éªŒè¯æ—¶é—´æˆ³?

**A**: ä½¿ç”¨æ¯”è¾ƒéªŒè¯å™¨:
```yaml
# éªŒè¯æ—¶é—´æˆ³å¤§äºæŸä¸ªæ—¶é—´ç‚¹
- type: gt
  path: "$.created_at"
  expect: 1704067200  # 2024-01-01 00:00:00

# éªŒè¯æ—¶é—´æˆ³åœ¨æœ€è¿‘24å°æ—¶å†…
- type: between
  path: "$.updated_at"
  expect: [1704067200, 1704153600]
```

### Q7: å¦‚ä½•éªŒè¯åµŒå¥—å¯¹è±¡ä¸­çš„å­—æ®µ?

**A**: ä½¿ç”¨å®Œæ•´JSONPathè·¯å¾„:
```yaml
# éªŒè¯åµŒå¥—å­—æ®µ
- type: eq
  path: "$.data.user.profile.avatar_url"
  expect: "https://example.com/avatar.jpg"

# ä½¿ç”¨é€’å½’æœç´¢
- type: exists
  path: "$..user_id"
  expect: true
```

### Q8: éªŒè¯å¤±è´¥æ—¶å¦‚ä½•æŸ¥çœ‹å®é™…å€¼å’ŒæœŸæœ›å€¼?

**A**:
1. ä½¿ç”¨ `-v` å‚æ•°è¿è¡Œæµ‹è¯•
2. æŸ¥çœ‹è¾“å‡ºçš„é”™è¯¯æ¶ˆæ¯,é»˜è®¤åŒ…å«å®é™…å€¼å’ŒæœŸæœ›å€¼
3. ä½¿ç”¨è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯æ ¼å¼åŒ–è¾“å‡º:
```yaml
- type: eq
  path: "$.status"
  expect: "success"
  error_message: "çŠ¶æ€éªŒè¯å¤±è´¥ - å®é™…: ${actual}, æœŸæœ›: ${expected}"
```

---

## æ›´å¤šèµ„æº

### ç¤ºä¾‹æ–‡ä»¶

- `examples/25_å­—ç¬¦ä¸²éªŒè¯å™¨.yaml` - å­—ç¬¦ä¸²éªŒè¯å™¨å®Œæ•´ç¤ºä¾‹
- `examples/26_å¢å¼ºåŠŸèƒ½æµ‹è¯•.yaml` - è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯ç¤ºä¾‹
- `examples/` - æ›´å¤šæµ‹è¯•ç”¨ä¾‹ç¤ºä¾‹

### ç›¸å…³æ–‡æ¡£

- [API-Engineè¾“å…¥åè®®è§„èŒƒ.md](API-Engineè¾“å…¥åè®®è§„èŒƒ.md) - YAMLæµ‹è¯•ç”¨ä¾‹å®Œæ•´è¯­æ³•
- [æå–å™¨ä½¿ç”¨æŒ‡å—.md](æå–å™¨ä½¿ç”¨æŒ‡å—.md) - å˜é‡æå–å®Œæ•´æŒ‡å—
- [CLAUDE.md](../CLAUDE.md) - é¡¹ç›®å¼€å‘æŒ‡å—

### å¤–éƒ¨å‚è€ƒ

- [JSONPath è¯­æ³•](https://goessner.net/articles/JsonPath/)
- [Python æ­£åˆ™è¡¨è¾¾å¼](https://docs.python.org/3/library/re.html)
- [pytest æ–­è¨€](https://docs.pytest.org/)

---

**æ–‡æ¡£ç»´æŠ¤**: Sisyphus API Engine å›¢é˜Ÿ
**æœ€åæ›´æ–°**: 2026-02-02
**ç‰ˆæœ¬**: v1.0
