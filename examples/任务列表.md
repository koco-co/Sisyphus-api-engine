# YAML 测试用例任务列表

> 本文档定义了 Sisyphus API Engine 的完整学习路线，每个 YAML 用例对应一个核心功能，由易到难循序渐进。

---

## 📋 任务列表

### 第一阶段：基础入门（01-05）

| 序号 | 文件名 | 功能描述 | 难度 | 状态 |
|------|--------|----------|------|------|
| 01 | `01_HTTP请求方法.yaml` | HTTP 请求方法（GET/POST/PUT/PATCH/DELETE/HEAD/OPTIONS） | ⭐ | 待创建 |
| 02 | `02_请求参数配置.yaml` | 请求参数（Query参数、Headers、Body、Form数据） | ⭐ | 待创建 |
| 03 | `03_变量基础语法.yaml` | 变量引用语法 `${variable}` 和变量作用域 | ⭐ | 待创建 |
| 04 | `04_内置模板函数.yaml` | 内置函数（random/uuid/timestamp/date/choice） | ⭐ | 待创建 |
| 05 | `05_变量提取器.yaml` | 从响应中提取变量（JSONPath/Regex/Header/Cookie） | ⭐⭐ | 待创建 |

### 第二阶段：断言验证（06-07）

| 序号 | 文件名 | 功能描述 | 难度 | 状态 |
|------|--------|----------|------|------|
| 06 | `06_基础断言验证.yaml` | 基础比较器（eq/ne/gt/lt/ge/le/contains） | ⭐⭐ | 待创建 |
| 07 | `07_高级断言验证.yaml` | 高级断言（regex/type/in/length/status_code/between） | ⭐⭐ | 待创建 |

### 第三阶段：环境与配置（08-09）

| 序号 | 文件名 | 功能描述 | 难度 | 状态 |
|------|--------|----------|------|------|
| 08 | `08_环境配置切换.yaml` | 多环境配置（profiles）和环境切换 | ⭐⭐ | 待创建 |
| 09 | `09_重试机制.yaml` | 简单重试和增强重试策略（fixed/exponential/linear） | ⭐⭐ | 待创建 |

### 第四阶段：流程控制（10-13）

| 序号 | 文件名 | 功能描述 | 难度 | 状态 |
|------|--------|----------|------|------|
| 10 | `10_步骤控制.yaml` | 条件执行（skip_if/only_if）和依赖（depends_on） | ⭐⭐ | 待创建 |
| 11 | `11_等待机制.yaml` | 固定延迟和条件等待 | ⭐⭐ | 待创建 |
| 12 | `12_循环控制.yaml` | for 循环和 while 循环 | ⭐⭐⭐ | 待创建 |
| 13 | `13_并发执行.yaml` | 并发执行多个请求 | ⭐⭐⭐ | 待创建 |

### 第五阶段：数据处理（14-16）

| 序号 | 文件名 | 功能描述 | 难度 | 状态 |
|------|--------|----------|------|------|
| 14 | `14_数据驱动测试.yaml` | 数据驱动测试（CSV/JSON/内联数据） | ⭐⭐⭐ | 待创建 |
| 15 | `15_数据库操作.yaml` | 数据库操作（SQLite/MySQL/PostgreSQL） | ⭐⭐⭐ | 待创建 |
| 16 | `16_脚本执行.yaml` | Python/JavaScript 脚本执行 | ⭐⭐⭐ | 待创建 |

### 第六阶段：高级特性（17）

| 序号 | 文件名 | 功能描述 | 难度 | 状态 |
|------|--------|----------|------|------|
| 17 | `17_完整流程测试.yaml` | 综合运用所有功能的完整流程 | ⭐⭐⭐⭐ | 待创建 |

### 额外示例

| 序号 | 文件名 | 功能描述 | 难度 | 状态 |
|------|--------|----------|------|------|
| 00 | `00_最佳实践.yaml` | 企业级测试用例最佳实践（放在最后） | ⭐⭐⭐⭐⭐ | 待创建 |

---

## 📝 编写规范

### YAML 文件规范

1. **文件命名**: `序号_功能名称.yaml`
2. **使用 httpbin.org**: 所有测试使用 `https://httpbin.org` 作为测试接口
3. **中文注释**: 所有配置项添加详细的中文注释
4. **枚举值注释**: 枚举类型使用中文注释说明可选值
5. **覆盖全面**: 每个功能点都要有对应的测试步骤

### 注释格式示例

```yaml
config:
  # 环境配置（可选值: dev/test/staging/prod）
  profiles:
    dev:
      base_url: "http://dev-api.example.com"

  # 全局变量
  variables:
    # 测试用户ID
    user_id: "10086"

steps:
  # 步骤1: GET请求示例
  - name: "测试GET请求"
    type: request  # 步骤类型: request/database/wait/loop/concurrent/script
    method: GET    # HTTP方法: GET/POST/PUT/PATCH/DELETE/HEAD/OPTIONS
    url: "https://httpbin.org/get"
```

### 测试用例结构

每个 YAML 文件应包含：

1. **用例描述**: 清晰说明本用例测试的功能点
2. **配置说明**: config 配置的详细注释
3. **测试步骤**: 循序渐进的测试步骤
4. **预期结果**: 每个步骤的验证断言

---

## 🚀 执行流程

1. 按照序号顺序创建 YAML 文件
2. 每创建一个文件，立即运行自测
3. 自测通过后，标记任务完成
4. 继续下一个文件

### 自测命令

```bash
# 运行单个用例
sisyphus-api-engine --cases examples/01_HTTP请求方法.yaml

# 详细输出模式
sisyphus-api-engine --cases examples/01_HTTP请求方法.yaml -v

# 验证 YAML 语法
sisyphus-api-validate examples/01_HTTP请求方法.yaml
```

---

## 📊 功能覆盖清单

### HTTP 请求
- [x] GET 请求
- [x] POST 请求（JSON Body）
- [x] PUT 请求
- [x] PATCH 请求
- [x] DELETE 请求
- [x] HEAD 请求
- [x] OPTIONS 请求
- [x] Query 参数
- [x] Headers 配置
- [x] Form 数据提交
- [x] 文件上传

### 变量系统
- [x] 全局变量
- [x] 环境变量引用
- [x] 模板变量渲染 `${}`
- [x] 嵌套变量引用
- [x] 变量默认值

### 内置函数
- [x] `random()` / `randint()` - 随机整数
- [x] `random_str()` - 随机字符串
- [x] `uuid()` - UUID（无横线）
- [x] `uuid4()` - UUID v4（标准格式）
- [x] `timestamp()` - Unix 时间戳
- [x] `timestamp_ms()` - 毫秒时间戳
- [x] `date()` - 格式化日期
- [x] `now()` - datetime 对象
- [x] `choice()` - 随机选择

### 变量提取
- [x] JSONPath 提取
- [x] 正则表达式提取
- [x] Header 提取
- [x] Cookie 提取

### 断言验证
- [x] `eq` - 等于
- [x] `ne` - 不等于
- [x] `gt` - 大于
- [x] `lt` - 小于
- [x] `ge` - 大于等于
- [x] `le` - 小于等于
- [x] `contains` - 包含
- [x] `not_contains` - 不包含
- [x] `regex` - 正则匹配
- [x] `type` - 类型检查
- [x] `in` - 在范围内
- [x] `not_in` - 不在范围内
- [x] `len_eq` / `len_gt` / `len_lt` - 长度比较
- [x] `is_empty` - 为空
- [x] `is_null` - 为 null
- [x] `status_code` - 状态码
- [x] `exists` - 存在
- [x] `between` - 在区间内

### 环境配置
- [x] profiles 多环境配置
- [x] active_profile 环境切换
- [x] 环境变量覆盖

### 重试机制
- [x] 简单重试 `retry_times`
- [x] 增强重试策略
  - [x] fixed - 固定延迟
  - [x] exponential - 指数退避
  - [x] linear - 线性增长
  - [x] jitter - 随机抖动
  - [x] retry_on - 按错误类型重试
  - [x] stop_on - 按错误类型停止

### 流程控制
- [x] `skip_if` - 条件跳过
- [x] `only_if` - 条件执行
- [x] `depends_on` - 依赖关系

### 等待机制
- [x] 固定延迟等待
- [x] 条件等待
- [x] 轮询间隔

### 循环控制
- [x] for 循环（固定次数）
- [x] while 循环（条件判断）
- [x] 循环变量引用
- [x] 循环内变量提取

### 并发执行
- [x] 并发请求
- [x] 并发数量控制

### 数据驱动
- [x] CSV 文件数据源
- [x] JSON 文件数据源
- [x] 内联数据
- [x] 数据迭代

### 数据库操作
- [x] SQLite
- [x] MySQL
- [x] PostgreSQL
- [x] query - 查询
- [x] exec - 单条执行
- [x] executemany - 批量执行
- [x] script - 脚本执行

### 脚本执行
- [x] Python 脚本
- [x] JavaScript 脚本
- [x] 变量读写（get_var/set_var）
- [x] 模块导入控制

---

## 📚 参考资料

- [API-Engine 输入协议规范](../docs/API-Engine输入协议规范.md)
- [API-Engine 输出协议规范](../docs/API-Engine输出协议规范.md)
- [CLAUDE.md](../CLAUDE.md) - 项目开发指南

---

*最后更新时间: 2026-01-29*
