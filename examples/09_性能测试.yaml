# Sisyphus API Engine - Performance Test Example
# 测试详细的性能指标收集

name: "性能指标测试"
description: "测试 HTTP 请求的详细性能指标收集功能"

config:
  name: "性能测试配置"
  active_profile: "prod"

  profiles:
    prod:
      base_url: "https://httpbin.org"

steps:
  # 测试1: 简单 GET 请求的性能指标
  - 测试GET请求性能:
      type: request
      url: "{{config.profiles.prod.base_url}}/get?test=performance"
      method: GET
      headers:
        User-Agent: "Sisyphus-Performance-Test"
      validations:
        - type: status_code
          path: "$.status_code"
          expect: "200"
          description: "验证请求成功"

  # 测试2: POST 请求的性能指标
  - 测试POST请求性能:
      type: request
      url: "{{config.profiles.prod.base_url}}/post"
      method: POST
      headers:
        Content-Type: "application/json"
      body:
        username: "testuser"
        email: "test@example.com"
        data:
          key1: "value1"
          key2: "value2"
          key3: "value3"
      validations:
        - type: status_code
          path: "$.status_code"
          expect: "200"
          description: "验证POST请求成功"

  # 测试3: 带延迟的请求测试
  - 测试带延迟请求性能:
      type: request
      url: "{{config.profiles.prod.base_url}}/delay/1"
      method: GET
      validations:
        - type: status_code
          path: "$.status_code"
          expect: "200"
          description: "验证延迟请求成功"

  # 测试4: 大响应数据测试
  - 测试大响应性能:
      type: request
      url: "{{config.profiles.prod.base_url}}/bytes/10240"
      method: GET
      validations:
        - type: status_code
          path: "$.status_code"
          expect: "200"
          description: "验证大响应成功"

  # 测试5: HTTPS 请求测试 TLS 指标
  - 测试HTTPS请求性能:
      type: request
      url: "{{config.profiles.prod.base_url}}/get"
      method: GET
      validations:
        - type: status_code
          path: "$.status_code"
          expect: "200"
          description: "验证HTTPS请求成功"

tags:
  - "performance"
  - "metrics"

enabled: true
