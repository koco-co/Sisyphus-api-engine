# ==============================================================================
# Sisyphus API Engine - 数据驱动示例
# ==============================================================================
# 配套文档：docs/10_数据驱动.md
# 功能说明：演示使用外部数据源驱动测试
# ==============================================================================

name: "数据驱动测试示例"
description: "演示CSV/JSON数据驱动测试"

config:
  profiles:
    prod:
      base_url: "https://httpbin.org"
  active_profile: "prod"
  
  # 数据驱动配置（需配合数据文件使用）
  # data_source:
  #   type: csv
  #   file_path: "data/users.csv"
  # data_iterations: true
  # variable_prefix: "data_"

steps:
  # 模拟数据驱动场景（使用内置数据）
  - name: "用户1测试"
    method: POST
    url: "${config.profiles.prod.base_url}/post"
    headers:
      Content-Type: "application/json"
    body:
      username: "user1"
      email: "user1@example.com"
      age: 25
    validations:
      - type: status_code
        path: "$.status_code"
        expect: "200"
      - type: eq
        path: "$.json.username"
        expect: "user1"

  - name: "用户2测试"
    method: POST
    url: "${config.profiles.prod.base_url}/post"
    headers:
      Content-Type: "application/json"
    body:
      username: "user2"
      email: "user2@example.com"
      age: 30
    validations:
      - type: status_code
        path: "$.status_code"
        expect: "200"
      - type: eq
        path: "$.json.username"
        expect: "user2"

  - name: "用户3测试"
    method: POST
    url: "${config.profiles.prod.base_url}/post"
    headers:
      Content-Type: "application/json"
    body:
      username: "user3"
      email: "user3@example.com"
      age: 35
    validations:
      - type: status_code
        path: "$.status_code"
        expect: "200"
      - type: eq
        path: "$.json.username"
        expect: "user3"

tags:
  - "数据驱动"
  - "参数化"
enabled: true

# 实际数据驱动使用示例（需创建对应的CSV文件）：
# 
# users.csv 内容：
# username,email,age
# user1,user1@example.com,25
# user2,user2@example.com,30
# user3,user3@example.com,35
#
# YAML配置：
# config:
#   data_source:
#     type: csv
#     file_path: "data/users.csv"
#   data_iterations: true
#   variable_prefix: "data_"
#
# steps:
#   - name: "数据驱动测试"
#     method: POST
#     url: "${base_url}/users"
#     body:
#       username: "${data_username}"
#       email: "${data_email}"
#       age: "${data_age}"
