# ==============================================================================
# Sisyphus API Engine - 并发执行示例
# ==============================================================================
# 配套文档：docs/09_并发执行.md
# 功能说明：演示多个请求并行执行
# ==============================================================================

name: "并发执行示例"
description: "演示多个请求并行执行以提高效率"

config:
  profiles:
    prod:
      base_url: "https://httpbin.org"
  active_profile: "prod"

steps:
  # 并发执行多个请求
  - name: "并发请求示例"
    description: "同时发送5个请求"
    type: concurrent
    max_concurrency: 5
    concurrent_steps:
      - name: "并发请求1"
        method: GET
        url: "${config.profiles.prod.base_url}/get"
        params:
          request: "1"
        validations:
          - type: status_code
            path: "$.status_code"
            expect: "200"
      
      - name: "并发请求2"
        method: GET
        url: "${config.profiles.prod.base_url}/get"
        params:
          request: "2"
        validations:
          - type: status_code
            path: "$.status_code"
            expect: "200"
      
      - name: "并发请求3"
        method: POST
        url: "${config.profiles.prod.base_url}/post"
        body:
          request: "3"
        validations:
          - type: status_code
            path: "$.status_code"
            expect: "200"
      
      - name: "并发请求4"
        method: GET
        url: "${config.profiles.prod.base_url}/uuid"
        validations:
          - type: status_code
            path: "$.status_code"
            expect: "200"
      
      - name: "并发请求5"
        method: GET
        url: "${config.profiles.prod.base_url}/headers"
        validations:
          - type: status_code
            path: "$.status_code"
            expect: "200"

  # 验证所有并发请求完成后继续
  - name: "并发完成后的步骤"
    method: GET
    url: "${config.profiles.prod.base_url}/get"
    params:
      after: "concurrent"
    validations:
      - type: status_code
        path: "$.status_code"
        expect: "200"

tags:
  - "并发"
  - "性能"
enabled: true
