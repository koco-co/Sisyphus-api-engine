# ==============================================================================
# Sisyphus API Engine - Mock服务器示例
# ==============================================================================
# 配套文档：docs/13_Mock服务器.md
# 功能说明：演示Mock服务器的配置和使用
# ==============================================================================

name: "Mock服务器示例"
description: "演示如何配置和使用内置Mock服务器"

config:
  profiles:
    prod:
      base_url: "https://httpbin.org"
    mock:
      base_url: "http://localhost:8888"
  active_profile: "prod"
  
  # Mock服务器配置
  # mock_server:
  #   enabled: true
  #   port: 8888
  #   routes:
  #     - path: "/api/users"
  #       method: GET
  #       response:
  #         status: 200
  #         headers:
  #           Content-Type: "application/json"
  #         body:
  #           code: 0
  #           data:
  #             users:
  #               - id: 1
  #                 name: "用户1"
  #               - id: 2
  #                 name: "用户2"
  #     - path: "/api/users"
  #       method: POST
  #       response:
  #         status: 201
  #         body:
  #           code: 0
  #           message: "创建成功"
  #           data:
  #             id: 3
  #     - path: "/api/users/{id}"
  #       method: DELETE
  #       response:
  #         status: 200
  #         body:
  #           code: 0
  #           message: "删除成功"

steps:
  # 演示Mock场景（使用httpbin模拟）
  - name: "模拟Mock GET请求"
    description: "实际使用时Mock服务器会返回配置的响应"
    method: GET
    url: "${config.profiles.prod.base_url}/get"
    params:
      mock: "true"
      endpoint: "/api/users"
    validations:
      - type: status_code
        path: "$.status_code"
        expect: "200"

  - name: "模拟Mock POST请求"
    method: POST
    url: "${config.profiles.prod.base_url}/post"
    headers:
      Content-Type: "application/json"
    body:
      mock: true
      endpoint: "/api/users"
      request_body:
        name: "新用户"
        email: "new@example.com"
    validations:
      - type: status_code
        path: "$.status_code"
        expect: "200"

tags:
  - "Mock"
  - "模拟"
enabled: true

# Mock服务器使用说明：
#
# 1. 在config.mock_server中配置路由
# 2. 启动测试时Mock服务器自动启动
# 3. 将请求URL指向Mock服务器地址
# 4. Mock服务器返回预定义的响应
#
# 适用场景：
# - 前端开发时后端API未就绪
# - 第三方服务不稳定或有调用限制
# - 需要模拟特定错误场景
# - 性能测试需要稳定的响应
